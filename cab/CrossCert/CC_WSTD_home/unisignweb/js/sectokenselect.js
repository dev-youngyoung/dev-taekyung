var __sectokenselect=function(b){var r=function(e){function q(b){if(!b)return alert("UI load error."),!1;var a=document.createElement("div");document.body.insertBefore(a,document.body.firstChild);a.innerHTML=b;return!0}function m(c){n.restoreOnMouseEvent();if(null==e.args||null==e.args.list)return b.uiUtil().msgBox(c.IDS_MSGBOX_ERROR_NO_SELECTED_DRIVER),!1;var a=e.args.list,h=e.args.list.length;if(0>=h)return b.uiUtil().msgBox(c.IDS_MSGBOX_ERROR_NO_SELECTED_DRIVER),!1;for(var d=!1,f=parseInt(n.selectedIndex()),k="",g=0;g<h;g++)if(a[g].index===f){k=a[g].name;d="invalid"==a[g].validity?!1:!0;break}if(!1==d&&!1==confirm(c.IDS_MSGBOX_CONFIRM_TRUSTLESS_DRIVER))return!1;e.onConfirm(f,k);return!0}function l(c){var a;if(null==e.args||null==e.args.list||0>=e.args.list.length)a=null;else{a=null;a=e.args.list;for(var h=e.args.list.length,d=[],f=0;f<h;f++){var k=[];k[0]=a[f].name;k[1]=a[f].driver;k[2]=a[f].passage;k[3]=a[f].index;d[f]=k}a={list:d}}s=b.loadUI("gridlist");n=s({type:"driverslist",tblid:"us-sectoken-select-tbl-list",tbltitleid:"us-sectoken-select-tbl-list-th",titlelistid:"us-sectoken-select-grid-head-div",titlerowid:"us-sectoken-select-list-title-row",titleelementid:"us-sectoken-select-list-title-element",titledividerid:"us-sectoken-select-list-title-divider",titlelistcn:"us-layout-sectoken-select-grid-head-div",titlerowcn:"us-layout-sectoken-select-grid-head-row",titleelementcn:"us-layout-sectoken-select-grid-row-title-element",titledividercn:"us-layout-sectoken-select-grid-row-title-divider",tblbodyid:"us-sectoken-select-tbl-list-td",datalistid:"us-sectoken-select-grid-body-div",datarowid:"us-sectoken-select-list-body-row",dataelementid:"us-sectoken-select-list-data-element",datalistcn:"us-layout-sectoken-select-grid-body-div",datarowcn:"us-layout-sectoken-select-grid-body-row",dataelementcn:"us-layout-sectoken-select-grid-row-data-element",dataselectcn:"us-layout-sectoken-select-grid-row-data-selected-element"});h=!0;"opera"==b.browserName&&(h=!1);a?n.drawList(c,c.length,a.list,a.list.length,g+2,h):n.drawList(c,c.length,null,0,g+2,h)}var p=function(){var c;c=window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP.3.0");c.open("GET",b.ESVS.SRCPath+"unisignweb/rsrc/layout/sectokenselect.html?V="+b.ver,!1);c.send(null);return c.responseText},r=function(){var c;c=window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP.3.0");c.open("GET",b.ESVS.SRCPath+"unisignweb/rsrc/lang/sectokenselect_"+b.ESVS.Language+".js?V="+b.ver,!1);c.send(null);return c.responseText},s=null,n=null,g=b.ESVS.TabIndex;return function(){var c=eval(p),a=eval(eval(r)());q(c());c=document.getElementById("us-sectoken-select-lbl-title");c.appendChild(document.createTextNode(a.IDS_SECTOKEN_SELECTION));c.setAttribute("tabindex",g,0);var h=document.getElementById("us-sectoken-select-lbl-notice");h.innerHTML=a.IDS_SECTOKEN_NOTICE;h.setAttribute("tabindex",g+1,0);var d=document.getElementById("us-sectoken-select-lbl-notice-txt");d.innerHTML=a.IDS_SECTOEKN_SUGGESTION;d.setAttribute("tabindex",g+3,0);d=document.getElementById("us-sectoken-select-install-driver-btn");d.setAttribute("value",a.IDS_SECTOKEN_DRIVER_INSTALL,0);d.setAttribute("title",a.IDS_SECTOKEN_DRIVER_INSTALL,0);d.setAttribute("tabindex",g+4,0);d.onclick=function(){"firefox"==b.browserName?window.open("http://rootca.or.kr/kor/hsm/hsm.jsp","hsm_url","scrollbars=1"):window.open("http://rootca.or.kr/kor/hsm/hsm.jsp");this.focus()};d=document.getElementById("us-fp-sectoken-select-install-driver-btn");d.setAttribute("value",a.IDS_FP_SECTOKEN_DRIVER_INSTALL,0);d.setAttribute("title",a.IDS_FP_SECTOKEN_DRIVER_INSTALL,0);d.setAttribute("tabindex",g+4,0);d.onclick=function(){"firefox"==b.browserName?window.open("https://www.crosscert.com/common/popup/popup_20120104.html","hsm_url","scrollbars=1"):window.open("https://www.crosscert.com/common/popup/popup_20120104.html");this.focus()};d=document.getElementById("us-sectoken-select-confirm-btn");d.setAttribute("value",a.IDS_CONFIRM,0);d.setAttribute("title",a.IDS_CONFIRM,0);d.setAttribute("tabindex",g+5,0);d.onclick=function(){m(a)};var f=document.getElementById("us-sectoken-select-cancel-btn");f.setAttribute("value",a.IDS_CANCEL,0);f.setAttribute("title",a.IDS_CANCEL,0);f.setAttribute("tabindex",g+6,0);f.onclick=function(){n.restoreOnMouseEvent();e.onCancel()};var k=document.getElementById("us-sectoken-select-cls-img-btn");k.setAttribute("title",a.IDS_SECTOKEN_SELECTION_CLOSE,0);k.setAttribute("tabindex",g+7,0);k.onclick=function(){n.restoreOnMouseEvent();e.onCancel()};document.getElementById("us-sectoken-select-cls-btn-img").setAttribute("src",b.ESVS.SRCPath+"unisignweb/rsrc/img/x-btn.png",0);b.uiUtil().setRotationTabFocus(f,d,c);b.uiUtil().setRotationTabFocus(c,f,h);l([{title:a.IDS_SECTOKEN_PRODUCT_NAME},{title:a.IDS_SECTOKEN_DRIVER_NAME},{title:a.IDS_SECTOKEN_EXAMINATION_PASSAGE}]);return document.getElementById("us-div-sectoken-select")}()};return function(e){var q=b.uiLayerLevel,m=b.uiUtil().getOverlay(q),l=r({type:e.type,args:e.args,onConfirm:e.onConfirm,onCancel:e.onCancel});l.style.zIndex=q+1;document.body.insertBefore(m,document.body.firstChild);var p=window.onresize;return{show:function(){draggable(l,document.getElementById("us-div-sectoken-select-title"));m.style.display="block";b.uiUtil().offsetResize(l);window.onresize=function(){b.uiUtil().offsetResize(l);p&&p()};b.uiLayerLevel+=10;b.ESVS.TabIndex+=30;setTimeout(function(){b.uiUtil().setFirstFocus("us-sectoken-select-lbl-title")},10)},hide:function(){m.style.display="none";l.style.display="none"},dispose:function(){window.onresize=function(){p&&p()};l.parentNode.parentNode.removeChild(l.parentNode);m.parentNode.removeChild(m);b.uiLayerLevel-=10;b.ESVS.TabIndex-=30}}}};