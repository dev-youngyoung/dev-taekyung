var __changepassword=function(b){var n=function(h){function l(a){if(!a)return alert("UI load error."),!1;var b=document.createElement("div");document.body.insertBefore(b,document.body.firstChild);b.innerHTML=a;return!0}function e(){var a=document.getElementById("us-change-password-new-first-textbox").value,c=document.getElementById("us-change-password-check-rule1"),d=document.getElementById("us-change-password-check-rule2"),f=document.getElementById("us-change-password-check-rule3"),g=document.getElementById("us-change-password-check-rule4"),h=document.getElementById("us-change-password-check-rule5"),e=!0;b.ESVS.LimitMinNewPWLen<=a.length?c.className="check":(c.className="",e=!1);"NPKI"===b.ESVS.PKI&&b.ESVS.ChangePWByNPKINewPattern||"NPKI"!=b.ESVS.PKI&&2===b.ESVS.LimitNewPWPattern?(c=/^(?=.*[a-zA-Z])(?=.*[0-9])(?=.*[^a-zA-Z0-9])/g,c.exec(a)?d.className="check":(d.className="",e=!1)):1===b.ESVS.LimitNewPWPattern&&(c=/^(?=.*[a-zA-Z])(?=.*[0-9])/g,c.exec(a)?d.className="check":(d.className="",e=!1));if("NPKI"===b.ESVS.PKI&&b.ESVS.ChangePWByNPKINewPattern)if(c=/['"\\|]/g,c.exec(a)?(h.className="",e=!1):h.className="check",2<a.length){for(d=0;d<a.length-2;d++)if(a.charAt(d)===a.charAt(d+1)&&a.charAt(d)===a.charAt(d+2)){f.className="";e=!1;break}else f.className="check";for(d=0;d<a.length-2;d++)if(a.charCodeAt(d)===a.charCodeAt(d+1)-1&&a.charCodeAt(d)===a.charCodeAt(d+2)-2){g.className="";e=!1;break}else g.className="check"}else f.className="check",g.className="check";return e}function g(a){var c=document.getElementById("us-change-password-origin-textbox"),d=document.getElementById("us-change-password-new-first-textbox"),f=document.getElementById("us-change-password-new-second-textbox");"touchen"==b.ESVS.SecureKeyboardType&&b.bsUtil().isTouchEnKeyUsable()&&(c.value=b.bsUtil().GetEncryptPwd("us-keyboard-secure-frm","us-change-password-origin-textbox"),d.value=b.bsUtil().GetEncryptPwd("us-keyboard-secure-frm2","us-change-password-new-first-textbox"),f.value=b.bsUtil().GetEncryptPwd("us-keyboard-secure-frm3","us-change-password-new-second-textbox"));if(!c.value||!d.value)return b.uiUtil().msgBox(a.IDS_MSGBOX_ERROR_PLEASE_INPUT_PASSWORD),c.focus(),!1;if(b.ESVS.LimitMaxNewPWLen<d.value.length)return b.uiUtil().msgBox(b.ESVS.LimitMaxNewPWLen+a.IDS_MSGBOX_ERROR_LONGER_THAN_LIMIT_MAX_LENGTH),d.focus(),!1;if(!e())return b.uiUtil().msgBox(a.IDS_MSGBOX_ERROR_CANT_PASS_RULES),d.focus(),!1;if(d.value!=f.value)return b.uiUtil().msgBox(a.IDS_MSGBOX_ERROR_PLEASE_RETRY_TO_INPUT_CORRECTLY),d.focus(),!1;h.onConfirm(c.value,d.value);c.value="";d.value="";f.value="";return!0}var k=function(){var a;a=window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP.3.0");a.open("GET",b.ESVS.SRCPath+"unisignweb/rsrc/layout/changepassword.html?version="+b.ver,!1);a.send(null);return a.responseText},m=function(){var a;a=window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP.3.0");a.open("GET",b.ESVS.SRCPath+"unisignweb/rsrc/lang/changepassword_"+b.ESVS.Language+".js?version="+b.ver,!1);a.send(null);return a.responseText},f=b.ESVS.TabIndex;return function(){var a=eval(k),c=eval(eval(m)());l(a());a=document.getElementById("us-change-password-lbl-title");a.appendChild(document.createTextNode(c.IDS_CHANGE_PASSWORD));a.setAttribute("tabindex",f,0);document.getElementById("us-change-password-cls-btn-img").setAttribute("src",b.ESVS.SRCPath+"unisignweb/rsrc/img/x-btn.png",0);document.getElementById("us-change-password-lock-img").setAttribute("src",b.ESVS.SRCPath+"unisignweb/rsrc/img/password-lock-img.png",0);document.getElementById("us-change-password-notice-text").innerHTML=c.IDS_CHANGE_PASSWORD_NOTICE+"<br>("+b.ESVS.LimitMinNewPWLen+c.IDS_CHANGE_PASSWORD_LIMIT+")";document.getElementById("us-change-password-origin-lbl").appendChild(document.createTextNode(c.IDS_CHANGE_PASSWORD_ORIGIN));document.getElementById("us-change-password-origin-textbox").setAttribute("tabindex",f+1,0);document.getElementById("us-change-password-new-first-lbl").appendChild(document.createTextNode(c.IDS_CHANGE_PASSWORD_NEW_FIRST));a=document.getElementById("us-change-password-new-first-textbox");a.setAttribute("tabindex",f+2,0);a.onkeyup=function(a){e()};document.getElementById("us-change-password-new-second-lbl").appendChild(document.createTextNode(c.IDS_CHANGE_PASSWORD_NEW_SECOND));document.getElementById("us-change-password-new-second-textbox").setAttribute("tabindex",f+3,0);document.getElementById("us-change-password-check-rule1").appendChild(document.createTextNode(b.ESVS.LimitMinNewPWLen+""+c.IDS_CHANGE_PASSWORD_RULE1));"NPKI"===b.ESVS.PKI&&b.ESVS.ChangePWByNPKINewPattern?(a=document.getElementById("us-change-password-check-rule2"),a.appendChild(document.createTextNode(c.IDS_CHANGE_PASSWORD_RULE2_ALL)),document.getElementById("us-change-password-check-rule3").appendChild(document.createTextNode(c.IDS_CHANGE_PASSWORD_RULE3)),document.getElementById("us-change-password-check-rule4").appendChild(document.createTextNode(c.IDS_CHANGE_PASSWORD_RULE4)),document.getElementById("us-change-password-check-rule5").appendChild(document.createTextNode(c.IDS_CHANGE_PASSWORD_RULE5))):(a=document.getElementById("us-change-password-check-rule2"),1===b.ESVS.LimitNewPWPattern?a.appendChild(document.createTextNode(c.IDS_CHANGE_PASSWORD_RULE2_ENGNUM)):"NPKI"!=b.ESVS.PKI&&2===b.ESVS.LimitNewPWPattern&&a.appendChild(document.createTextNode(c.IDS_CHANGE_PASSWORD_RULE2_ALL)));document.getElementById("us-change-password-warning-text").appendChild(document.createTextNode(c.IDS_CHANGE_PASSWORD_WARNING));a=document.getElementById("us-change-password-confirm-btn");a.setAttribute("value",c.IDS_CONFIRM,0);a.setAttribute("title",c.IDS_CONFIRM+c.IDS_BUTTON,0);a.setAttribute("tabindex",f+4,0);a.onclick=function(){g(c)};a=document.getElementById("us-change-password-cancel-btn");a.setAttribute("value",c.IDS_CANCEL,0);a.setAttribute("title",c.IDS_CANCEL+c.IDS_BUTTON,0);a.setAttribute("tabindex",f+5,0);a.onclick=function(){h.onCancel()};a=document.getElementById("us-change-password-cls-img-btn");a.setAttribute("title",c.IDS_CHANGE_PASSWORD_CLOSE,0);a.setAttribute("tabindex",f+6,0);a.onclick=function(){h.onCancel()};return document.getElementById("us-div-change-password")}()};return function(h){var l=b.uiLayerLevel,e=b.uiUtil().getOverlay(l),g=n({type:h.type,args:h.args,onConfirm:h.onConfirm,onCancel:h.onCancel});g.style.zIndex=l+1;b.ESVS.TargetObj.insertBefore(e,b.ESVS.TargetObj.firstChild);var k=window.onresize;return{show:function(){draggable(g,document.getElementById("us-div-change-password-title"));e.style.display="block";b.uiUtil().offsetResize(g);window.onresize=function(){b.uiUtil().offsetResize(g);k&&k()};b.uiLayerLevel+=10;b.ESVS.TabIndex+=30;setTimeout(function(){var e=g.getElementsByTagName("p");if(0<e.length)for(var f=0;f<e.length;f++)"us-change-password-lbl-title"==e[f].id&&e[f].focus();b.bsUtil().SetSecurityStatus("us-change-password-origin-textbox");b.bsUtil().SetSecurityStatus("us-change-password-new-first-textbox");b.bsUtil().SetSecurityStatus("us-change-password-new-second-textbox");b.bsUtil().SetReScan("us-keyboard-secure-frm","us-change-password-origin-textbox");b.bsUtil().SetReScan("us-keyboard-secure-frm2","us-change-password-new-first-textbox");b.bsUtil().SetReScan("us-keyboard-secure-frm3","us-change-password-new-second-textbox")},10)},hide:function(){e.style.display="none";g.style.display="none"},dispose:function(){window.onresize=function(){k&&k()};g.parentNode.parentNode.removeChild(g.parentNode);e.parentNode.removeChild(e);b.uiLayerLevel-=10;b.ESVS.TabIndex-=30}}}};