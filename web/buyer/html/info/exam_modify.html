<form novalidate name="form1" method="post"  onsubmit="return formSubmit(this);">
	<div class="div_table">
		<div class="util-row">
			<div class="push-left">
				<h3>기본정보</h3>
			</div>
		</div>
		<table>
		<colgroup>
			<col width="15%">
			<col width="35%">
			<col width="15%">
			<col width="35%">
		</colgroup>
		<tr>
			<th>평가지명</th>
			<td colspan="3"><input type="text" name="exam_name" style="width: 98%"/></td>
		</tr>
		<tr>
			<th>문항DEPTH</th>
			<td>
				<select name="question_depth" onchange="chgDepth(this.value)">
					<option value="2">2depth</option>
					<option value="3">3depth</option>
				</select>
			</td>
			<th>평가 항목수</th>
			<td> &nbsp;<span id="question_cnt_area"></span> 개 항목 <input type="hidden" name="question_cnt"/></td>
		</tr>
		<!-- IFNOT START 'isCJ' -->
		<tr>
			<th>평가 유형</th>
			<td colspan="3">
				<!-- LOOP START 'code_exam_type' -->
				&nbsp;<input type="radio" name="exam_type" value="{{code_exam_type.id}}"/>{{code_exam_type.value}}
				<!-- LOOP END 'code_exam_type' -->
			</td>
		</tr>
		<!-- IFNOT END 'isCJ' -->
		</table>
	</div>
	<div id="qustion_area">
	</div>

	<div class="btn-group-wrap">
		<!-- IFNOT START 'modify' -->
		<button type="submit" class="btn color ico-save"><span></span>저장</button>
		<button type="button" class="btn color ico-cancel" onclick="location.href='exam_list.jsp?{{list_query}}';"><span></span>취소</button>
		<!-- IFNOT END 'modify' -->
		<!-- IF START 'modify' -->
		<button type="submit" class="btn color ico-save"><span></span>저장</button>
		<button type="button" class="btn color ico-cancel" onclick="location.href='exam_view.jsp?{{query}}';"><span></span>취소</button>
		<button type="button" class="btn color ico-list" onclick="location.href='exam_list.jsp?{{list_query}}';"><span></span>목록으로</button>
		<!-- IF END 'modify' -->
	</div>
</form>
{{form_script}}
<div id="depth2" style="display:none;">
	<div class="div_table">
		<div class="util-row">
			<div class="push-left">
				<h3>평가항목(2depth)</h3>
			</div>
			<div class="push-right">
				<button type="button" class="sbtn ico-add" onclick="addRow()"><span></span>추가</button>
			</div>
		</div>
		<table id="depth2_html">
		<colgroup>
			<col width="25%">
			<col width="35%">
			<col width="5%">
			<!-- IF START 'isCJ' -->
			<col width="6%">
			<col width="8%">
			<!-- IF END 'isCJ' -->
			<col width="*">
			<col width="10%">
		</colgroup>
		<thead>
		<tr>
			<th>분류</th>
			<th>세부항목</th>
			<th>배점</th>
			<!-- IF START 'isCJ' -->
			<th>가중치</th>
			<th>환산배점</th>
			<!-- IF END 'isCJ' -->
			<th>비고</th>
			<th>삭제</th>
		</tr>
		</thead>
		<tbody>
		<!-- IFNOT START 'modify' -->
		<tr style="height: 40px;">
			<td align="center"><input type="text" name="l_div_nm" maxlength="200" style="width:98%"  required="Y" hname="분류" value=""></td>
			<td align="center"><input type="text" name="m_div_nm" maxlength="200" style="width:98%"  required="Y" hname="세부항목" value=""></td>
			<td align="center"><input type="text" name="point" maxlength="3" size="2" value="100" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" onChange="cal()" hname="배점"></td>
			<!-- IF START 'isCJ' -->
				<td align="center"><input type="text" name="rate" maxlength="2" size="2" value="30" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" onChange="cal()" hname="가중치">%</td>
				<td align="center"><input type="text" name="rate_point" maxlength="5" size="5" value="30" size="2" readonly class="label_none" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" hname="환산점수"></td>
			<!-- IF END 'isCJ' -->
			<td align="center"><textarea name="etc" style="width:98%" rows="2"></textarea></td>
			<td align="center"><button type="button" class="sbtn ico-delete" onclick="delRow(this)"><span></span>삭제</button></td>
		</tr>
		<!-- IFNOT END 'modify' -->
		<!-- IF START 'modify' -->
			<!-- LOOP START 'question' -->
			<tr style="height: 40px;">
				<td align="center"><input type="text" name="l_div_nm" maxlength="200" style="width:98%" value="{{question.l_div_nm}}"  required="Y" hname="분류"></td>
				<td align="center"><input type="text" name="m_div_nm" maxlength="200" style="width:98%" value="{{question.m_div_nm}}" required="Y" hname="세부항목"></td>
				<td align="center">
					<input type="hidden" name="question_cd" value="{{question.question_cd}}"/>
					<input type="text" name="point" maxlength="3" size="2" value="{{question.point}}" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" onChange="cal()" hname="배점"></td>
				<!-- IF START 'isCJ' -->
				<td align="center"><input type="text" name="rate" maxlength="2" size="2" value="{{question.rate}}" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" onChange="cal()" hname="가중치">%</td>
				<td align="center"><input type="text" name="rate_point" maxlength="5" size="5" value="{{question.rate_point}}" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" hname="환산점수"></td>
				<!-- IF END 'isCJ' -->
				<td align="center"><textarea name="etc"  style="width:98%" rows="2">{{question.etc}}</textarea></td>
				<td align="center"><button type="button" class="sbtn ico-delete" onclick="delRow(this)"><span></span>삭제</button></td>
			</tr>
			<!-- LOOP END 'question' -->
		<!-- IF END 'modify' -->
		</tbody>
		</table>
	</div>
</div>

<div id="depth3" style="display:none;">
	<div class="div_table">
		<div class="util-row">
			<div class="push-left">
				<h3>평가항목(3depth)</h3>
			</div>
			<div class="push-right">
				<button type="button" class="sbtn ico-add" onclick="addRow()"><span></span>추가</button>
			</div>
		</div>
		<table id="depth3_html">
		<colgroup>
			<col width="15%">
			<col width="20%">
			<col width="20%">
			<col width="5%">
			<!-- IF START 'isCJ' -->
			<col width="8%">
			<col width="8%">
			<!-- IF END 'isCJ' -->
			<col width="">
			<col width="10%">
		</colgroup>
		<thead>
		<tr>
			<th>대분류</th>
			<th>중분류</th>
			<th>세부항목</th>
			<th>배점</th>
			<!-- IF START 'isCJ' -->
			<th>가중치</th>
			<th>환산배점</th>
			<!-- IF END 'isCJ' -->
			<th>비고</th>
			<th>삭제</th>
		</tr>
		</thead>
		<tbody>
		<!-- IFNOT START 'modify' -->

		<!-- IF START 'isCJ' -->
		<tr style="height: 40px;">
			<td align="center"><input type="text" name="l_div_nm" maxlength="200" value="재무상태 평가" style="width:98%" required="Y" hname="대분류"></td>
			<td align="center"><input type="text" name="m_div_nm" maxlength="200" value="수익성지표" style="width:98%" required="Y" hname="중뷴류"></td>
			<td align="center"><input type="text" name="s_div_nm" maxlength="200" value="영업이익률" style="width:98%" required="Y" hname="세부항목"></td>
			<td align="center"><input type="text" name="point" maxlength="3" size="2" value="20" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" onChange="cal()" hname="배점"></td>
			<td align="center"><input type="text" name="rate" maxlength="2" size="2" value="10" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" onChange="cal()" hname="가중치">%</td>
			<td align="center"><input type="text" name="rate_point" maxlength="5" size="5" value="2" readonly class="label_none" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" hname="환산점수"></td>
			<td align="center"><textarea name="etc" style="width:98%;overflow:hidden" rows="2">크레탑 자동평가 항목</textarea></td>
			<td align="center"><button type="button" class="sbtn ico-delete" onclick="delRow(this)" style="margin-top:5px;"><span></span>삭제</button></td>
		</tr>
		<tr style="height: 40px;">
			<td align="center"><input type="text" name="l_div_nm" maxlength="200" value="재무상태 평가" style="width:98%" required="Y" hname="대분류"></td>
			<td align="center"><input type="text" name="m_div_nm" maxlength="200" value="안정성지표Ⅰ" style="width:98%" required="Y" hname="중뷴류"></td>
			<td align="center"><input type="text" name="s_div_nm" maxlength="200" value="부채비율" style="width:98%" required="Y" hname="세부항목"></td>
			<td align="center"><input type="text" name="point" maxlength="3" size="2" value="20" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" onChange="cal()" hname="배점"></td>
			<td align="center"><input type="text" name="rate" maxlength="2" size="2" value="10" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" onChange="cal()" hname="가중치">%</td>
			<td align="center"><input type="text" name="rate_point" maxlength="5" size="5" value="2" readonly class="label_none" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" hname="환산점수"></td>
			<td align="center"><textarea name="etc" style="width:98%;overflow:hidden" rows="2">크레탑 자동평가 항목</textarea></td>
			<td align="center"><button type="button" class="sbtn ico-delete" onclick="delRow(this)"><span></span>삭제</button></td>
		</tr>
		<tr style="height: 40px;">
			<td align="center"><input type="text" name="l_div_nm" maxlength="200" value="재무상태 평가" style="width:98%" required="Y" hname="대분류"></td>
			<td align="center"><input type="text" name="m_div_nm" maxlength="200" value="안정성지표Ⅱ" style="width:98%" required="Y" hname="중뷴류"></td>
			<td align="center"><input type="text" name="s_div_nm" maxlength="200" value="유동비율" style="width:98%" required="Y" hname="세부항목"></td>
			<td align="center"><input type="text" name="point" maxlength="3" size="2" value="20" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" onChange="cal()" hname="배점"></td>
			<td align="center"><input type="text" name="rate" maxlength="2" size="2" value="10" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" onChange="cal()" hname="가중치">%</td>
			<td align="center"><input type="text" name="rate_point" maxlength="5" size="5" value="2" readonly class="label_none" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" hname="환산점수"></td>
			<td align="center"><textarea name="etc" style="width:98%;overflow:hidden" rows="2">크레탑 자동평가 항목</textarea></td>
			<td align="center"><button type="button" class="sbtn ico-delete" onclick="delRow(this)"><span></span>삭제</button></td>
		</tr>
		<tr style="height: 40px;">
			<td align="center"><input type="text" name="l_div_nm" maxlength="200" value="재무상태 평가" style="width:98%" required="Y" hname="대분류"></td>
			<td align="center"><input type="text" name="m_div_nm" maxlength="200" value="안정성지표Ⅲ" style="width:98%" required="Y" hname="중뷴류"></td>
			<td align="center"><input type="text" name="s_div_nm" maxlength="200" value="신용등급" style="width:98%" required="Y" hname="세부항목"></td>
			<td align="center"><input type="text" name="point" maxlength="3" size="2" value="20" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" onChange="cal()" hname="배점"></td>
			<td align="center"><input type="text" name="rate" maxlength="2" size="2" value="10" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" onChange="cal()" hname="가중치">%</td>
			<td align="center"><input type="text" name="rate_point" maxlength="5" size="5" value="2" readonly class="label_none" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" hname="환산점수"></td>
			<td align="center"><textarea name="etc" style="width:98%;overflow:hidden" rows="2">크레탑 자동평가 항목</textarea></td>
			<td align="center"><button type="button" class="sbtn ico-delete" onclick="delRow(this)"><span></span>삭제</button></td>
		</tr>
		<tr style="height: 40px;">
			<td align="center"><input type="text" name="l_div_nm" maxlength="200" value="재무상태 평가" style="width:98%" required="Y" hname="대분류"></td>
			<td align="center"><input type="text" name="m_div_nm" maxlength="200" value="세급체납" style="width:98%" required="Y" hname="중뷴류"></td>
			<td align="center"><input type="text" name="s_div_nm" maxlength="200" value="최근 1개년" style="width:98%" required="Y" hname="세부항목"></td>
			<td align="center"><input type="text" name="point" maxlength="3" size="2" value="20" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" onChange="cal()" hname="배점"></td>
			<td align="center"><input type="text" name="rate" maxlength="2" size="2" value="10" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" onChange="cal()" hname="가중치">%</td>
			<td align="center"><input type="text" name="rate_point" maxlength="5" size="5" value="2" readonly class="label_none" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" hname="환산점수"></td>
			<td align="center"><textarea name="etc" style="width:98%;overflow:hidden" rows="2">크레탑 자동평가 항목</textarea></td>
			<td align="center"><button type="button" class="sbtn ico-delete" onclick="delRow(this)"><span></span>삭제</button></td>
		</tr>
		<tr style="height: 40px;">
			<td align="center"><input type="text" name="l_div_nm" maxlength="200" value="가격점수 평가" style="width:98%" required="Y" hname="대분류"></td>
			<td align="center"><input type="text" name="m_div_nm" maxlength="200" value="가격" style="width:98%" required="Y" hname="중뷴류"></td>
			<td align="center"><input type="text" name="s_div_nm" maxlength="200" value="1순위대비" style="width:98%" required="Y" hname="세부항목"></td>
			<td align="center"><input type="text" name="point" maxlength="3" size="2" value="100" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" onChange="cal()" hname="배점"></td>
			<td align="center"><input type="text" name="rate" maxlength="2" size="2" value="60" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" onChange="cal()" hname="가중치">%</td>
			<td align="center"><input type="text" name="rate_point" maxlength="5" size="5" value="60" readonly class="label_none" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" hname="환산점수"></td>
			<td align="center"><textarea name="etc" style="width:98%;overflow:hidden" rows="2">투찰가 자동평가 항목</textarea></td>
			<td align="center"><button type="button" class="sbtn ico-delete" onclick="delRow(this)"><span></span>삭제</button></td>
		</tr>
		<tr style="height: 40px;">
			<td align="center"><input type="text" name="l_div_nm" maxlength="200" value="운영능력 평가" style="width:98%"  required="Y" hname="대분류"></td>
			<td align="center"><input type="text" name="m_div_nm" maxlength="200" value="운송실적" style="width:98%"  required="Y" hname="중뷴류"></td>
			<td align="center"><input type="text" name="s_div_nm" maxlength="200" value="유사 대형물량" style="width:98%"  required="Y" hname="세부항목"></td>
			<td align="center"><input type="text" name="point" maxlength="3" size="2" value="100" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" onChange="cal()" hname="배점"></td>
			<td align="center"><input type="text" name="rate" maxlength="2" size="2" value="30" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" onChange="cal()" hname="가중치">%</td>
			<td align="center"><input type="text" name="rate_point" maxlength="5" size="5" value="30" size="2" readonly class="label_none" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" hname="환산점수"></td>
			<td align="center"><textarea name="etc" style="width:98%;overflow:hidden" rows="2"></textarea></td>
			<td align="center"><button type="button" class="sbtn ico-delete" onclick="delRow(this)"><span></span>삭제</button></td>
		</tr>
		<!-- IF END 'isCJ' -->

		<!-- IFNOT START 'isCJ' -->
		<tr style="height: 40px;">
			<td align="center"><input type="text" name="l_div_nm" maxlength="200" style="width:98%"  required="Y" hname="대분류"></td>
			<td align="center"><input type="text" name="m_div_nm" maxlength="200" style="width:98%"  required="Y" hname="중뷴류"></td>
			<td align="center"><input type="text" name="s_div_nm" maxlength="200" style="width:98%"  required="Y" hname="세부항목"></td>
			<td align="center"><input type="text" name="point" maxlength="2" size="2"  style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" hname="배점"></td>
			<td align="center"><textarea name="etc" style="width:98%" rows="2"></textarea></td>
			<td align="center"><button type="button" class="sbtn ico-delete" onclick="delRow(this)"><span></span>삭제</button></td>
		</tr>
		<!-- IFNOT END 'isCJ' -->

		<!-- IFNOT END 'modify' -->
		<!-- IF START 'modify' -->
			<!-- LOOP START 'question' -->
			<tr style="height: 40px;">
				<td align="center"><input type="text" name="l_div_nm" maxlength="200" style="width:98%" value="{{question.l_div_nm}}"  required="Y" hname="대분류"></td>
				<td align="center"><input type="text" name="m_div_nm" maxlength="200" style="width:98%" value="{{question.m_div_nm}}" required="Y" hname="중뷴류"></td>
				<td align="center"><input type="text" name="s_div_nm" maxlength="200" style="width:98%" value="{{question.question}}" required="Y" hname="세부항목"></td>
				<td align="center">
					<input type="hidden" name="question_cd" value="{{question.question_cd}}"/>
					<input type="text" name="point" maxlength="3" size="2" value="{{question.point}}" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" onChange="cal()" hname="배점">
				</td>
				<!-- IF START 'isCJ' -->
				<td align="center"><input type="text" name="rate" maxlength="2" size="2" value="{{question.rate}}" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" onChange="cal()" hname="가중치">%</td>
				<td align="center"><input type="text" name="rate_point" maxlength="5" size="5" value="{{question.rate_point}}" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_only()" onkeypress="num_only()" hname="환산점수"></td>
				<!-- IF END 'isCJ' -->
				<td align="center"><textarea name="etc"  style="width:98%" rows="2">{{question.etc}}</textarea></td>
				<td align="center"><button type="button" class="sbtn ico-delete" onclick="delRow(this)"><span></span>삭제</button></td>
			</tr>
			<!-- LOOP END 'question' -->
		<!-- IF END 'modify' -->
		</tbody>
		</table>
	</div>
</div>

<!-- IF START 'isCJ' -->

<br/>
<div class="help-content">
    <h3>NOTICE<span>유용한 정보! 사용전에 알아두세요~ </span></h3>
    <div class="help-content-body">
        <h4>작성안내</h4>
        <ul>
			<li>환산점수는 각 항목별 배점 가중치를 반영한 실평가 배점이며, 환산점수의 총합은 100점 만점이어야 합니다.</li>
			<li>"크레탑 자동평가 항목"은 [거래업체관리-기업현황조회] 메뉴에 등록된 점수를 기반으로 낙찰업체 평가시 자동 평가됩니다.</li>
			<li>
				"투찰가 자동평가 항목"은 낙찰업체 평가시 1순위 투찰업체의 금액에 따라 자동 평가됩니다.<br>
				 - 10억미만 : 평가점수 = 100 - ( (평가업체금액 - 1순위 금액) ÷ 1순위 금액 × 100 )<br>
				 - 10억이상 : 평가점수 = 100 - ( (평가업체금액 - 1순위 금액) ÷ 1순위 금액 × 100 ) - ( (평가업체금액 - 1순위 금액) ÷ 1천만원) × 0.2 )
		 	</li>
        </ul>
    </div>
</div>

<!-- IF END 'isCJ' -->

<script language="javascript">

function formSubmit(f){
	if(validate(f)){
		var cnt = document.getElementById('question_grid').rows.length -1;
		if(cnt < 2){
			alert("평가  항목을 2가지 이상 입력 하세요.");
			return false;
		}
		var l_div_nm = "";
		var m_div_nm = "";
		var s_div_nm = "";
		for(var i = 0 ; i < f['l_div_nm'].length ; i++ ){
			 
			for(var j = 0 ; j < f['l_div_nm'].length ; j++ ){
				if(i == j) continue;
				if(f['s_div_nm']){
					if(f['l_div_nm'][i].value == f['l_div_nm'][j].value && f['m_div_nm'][i].value == f['m_div_nm'][j].value && f['s_div_nm'][i].value == f['s_div_nm'][j].value){
						alert("중복 항목이 있습니다. 평가 항목을 확인해 주세요.");
						return false;
					}
				}else{
					if(f['l_div_nm'][i].value == f['l_div_nm'][j].value && f['m_div_nm'][i].value == f['m_div_nm'][j].value){
						alert("중복 항목이 있습니다. 평가 항목을 확인해 주세요.");
						return false;
					}
				}
			}
		}
		
		<!-- IFNOT START 'isCJ' -->
		var point = 0;
		for(var i = 0; i < f['point'].length; i ++){
			point += parseInt(f['point'][i].value,10);
		}
		if(point != 100){
			alert("배점의 합은 100점이여야 합니다.");
			return false;
		}
		<!-- IFNOT END 'isCJ' -->

		<!-- IF START 'isCJ' -->
		var rate_point = 0;
		for(var i = 0; i < f['point'].length; i ++){
			rate_point += parseInt(f['rate_point'][i].value,10);
		}
		if(rate_point != 100){
			alert("환산 배점의 점수가 "+rate_point+"점입니다.\n\n환산 배점을 100점으로 설정해주세요.");
			return false;
		}
		<!-- IF END 'isCJ' -->
		
		if(confirm("저장하시겠습니까?"))
			return true;
	}
	return false;	
}


var question_grid = null; 

var depth = "3";
function chgDepth(inVal){
	if(inVal == "") inVal="3";
	var area = document.getElementById("qustion_area");
	if(area.innerHTML.trim() != ""){
		if(area.innerHTML !=document.getElementById("depth"+depth).innerHTML){
			if(!confirm("변경시 저장하지 않은 정보는 삭제 됩니다.\n\n변경 하시겠습니까?")){
				return;
			}
		}
	}
	depth = inVal;
	area.innerHTML = document.getElementById("depth"+depth).innerHTML;
	var tables = area.getElementsByTagName("table");
	tables[0].id = "question_grid";
	question_grid = new MGRID("question_grid");
	
	var table = document.getElementById("depth"+depth+"_html").getElementsByTagName("tbody")[0];
	var row = table.rows[0];
	var arr = new Array(row.cells.length);
	for(var i = 0 ; i < arr.length; i ++){
		arr[i]= row.cells[i].innerHTML;
	}
	question_grid.cells = arr
	setQuestionCont();
}
chgDepth("{{exam.question_depth}}");

function addRow(){
	var f = document.forms['form1'];
	question_grid.addRow();
	if(question_grid.rowIndex>1){
		f['l_div_nm'][question_grid.rowIndex-1].value = f['l_div_nm'][question_grid.rowIndex-2].value;
		f['m_div_nm'][question_grid.rowIndex-1].value = f['m_div_nm'][question_grid.rowIndex-2].value;
		if(f['s_div_nm']){
		f['s_div_nm'][question_grid.rowIndex-1].value = f['s_div_nm'][question_grid.rowIndex-2].value;
		}
		f['point'][question_grid.rowIndex-1].value = "";
		<!-- IF START 'isCJ' -->
		f['l_div_nm'][question_grid.rowIndex-1].value = "운영능력 평가";
		f['rate'][question_grid.rowIndex-1].value = "";
		f['rate_point'][question_grid.rowIndex-1].value = "";
		<!-- IF END 'isCJ' -->
		f['etc'][question_grid.rowIndex-1].value = f['etc'][question_grid.rowIndex-2].value;
	}
	setQuestionCont(); 
}
function delRow(obj){
	<!-- IF START 'isCJ' -->
	var row = question_grid.findRow(obj);
	if(row.rowIndex < 7) {
		alert("기본 평가 항목은 삭제하실 수 없습니다.");
		return;
	}
	<!-- IF END 'isCJ' -->
	question_grid.del(obj);
	setQuestionCont();
}

function setQuestionCont(){
	var f = document.forms['form1'];
	var area = document.getElementById('question_cnt_area');
	var cnt = document.getElementById('question_grid').rows.length -1;
	area.innerHTML = cnt;
	f['question_cnt'].value = cnt;
}

function cal(){
	var f = document.forms['form1'];
	if(!f['rate_point'])return;
	var point = f['point'];
	var rate = f['rate'];
	var rate_point = f['rate_point'];
	
	for(var i=0; i<point.length; i++)
	{
		rate_point[i].value = (point[i].value * (rate[i].value / 100)).toFixed(2);  // 소수점 3째에서 반올림
	}
	
}

</script>
