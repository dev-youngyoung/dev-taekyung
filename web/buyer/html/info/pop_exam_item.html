<form name="form1" method="post" onsubmit="return formSubmit(this);">
<input type="hidden" name="search" value="1">
<div class="div_table">
    <div class="util-row">
        <div class="push-right">
            <button type="submit"  class="sbtn color ico-save" value="저장"><span></span>저장</button>
            <button type="button" class="sbtn color ico-cancel"  onclick="self.close()"><span></span>닫기</button>
        </div>
    </div>
    <div class="push-left">
        <h3>평가항목정보</h3>
    </div>
    <table>
      <colgroup>
        <col width="20%">
        <col width="80%">
      </colgroup>
      <!-- IF START '2depth' -->
       <tr>
        <th>분류</th>
        <td>{{question.l_div_nm}}</td>
      </tr>
      <tr>
        <th>세부항목</th>
        <td>{{question.m_div_nm}}</td>
      </tr>
      <!-- IF END '2depth' -->
      <!-- IF START '3depth' -->
      <tr>
        <th>대분류</th>
        <td>{{question.l_div_nm}}</td>
      </tr>
      <tr>
        <th>중분류</th>
        <td>{{question.m_div_nm}}</td>
      </tr>
      <tr>
        <th>세부항목</th>
        <td>{{question.question}}</td>
      </tr>
      <!-- IF END '3depth' -->
      <tr>
        <th>총점</th>
        <td>{{question.point}} 점</td>
      </tr>
      <tr>
        <th>비고</th>
        <td>{{question.etc}}</td>
      </tr>
     </table>
</div>

<div class="div_table">
    <div class="util-row">
        <div class="push-left">
            <h3>평가배점</h3>
        </div>
        <div class="push-right">
            <button type="button" class="sbtn ico-add" onclick="item_grid.addRow()"><span></span>추가</button>
        </div>
    </div>
    <table id="item_grid">
        <colgroup>
            <col width="62%">
            <col width="20%">
            <col width="18%">
        </colgroup>
        <thead>
        <tr>
            <th>배점명</th>
            <th>점수</th>
            <th>삭제</th>
        </tr>
        </thead>
        <tbody>
        <!-- LOOP START 'item' -->
        <tr>
            <td align="center"><input type="text" name="item_text" style="width:98%" maxlength="10" value="{{item.item_text}}" requred="Y" hname="배점명"/></td>
            <td align="center"><input type="text" name="point" size="5" maxlength="6" value="{{item.point}}" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_point_only()" onkeypress="num_point_only()" hname="점수" /></td>
            <td align="center"><button class="sbtn ico-delete" onclick="item_grid.del(this)"><span></span>삭제</button></td>
        </tr>
        <!-- LOOP END 'item' -->
        </tbody>
    </table>
</div>
</form>
{{form_script}}
<script language="javascript">

var item_grid =  new MGRID("item_grid");
	item_grid.cells = new Array('<input type="text" name="item_text" style="width:98%" maxlength="10" requred="Y" hname="배점명"/>'
	                            ,'<input type="text" name="point" size="4" maxlength="5" style="ime-mode:disabled;text-align:right" required="Y" onkeydown="num_point_only()" onkeypress="num_point_only()" hname="점수" />'
	                            ,'<button class="sbtn ico-delete" onclick="item_grid.del(this)"><span></span>삭제</button>');

function formSubmit(f){
	
	if(validate(f)){
		var cnt = document.getElementById("item_grid").rows.length;
		if(cnt<2){
			alert("배점항목을 2개 이상 입력 하세요.");
			return false;
		}
		var max_point = parseInt("{{question.point}}",10);
		for(var i = 0; i< f['point'].length; i ++){
			var point = parseInt(f['point'][i].value, 10);
			if(max_point<point){
				alert("배점을 총점 이상으로 입력 할 수 없습니다.");
				f['point'][i].focus();
				return false;
			}
		} 
		if(confirm('저장하시겠습니까?')) return true;
	}
	return false;
}
</script>