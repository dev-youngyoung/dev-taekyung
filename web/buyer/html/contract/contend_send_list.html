<form name="form1" method="get" onsubmit="return formSubmit(this);">
<input type="hidden" name="mode">
<input type="hidden" name="hdn_sort_column">
<input type="hidden" name="hdn_sort_order">
<div class="search_div">
	<table class="search_table">
		<colgroup>
			<col width="13%">
			<col width="44%">
			<col width="13%">
			<col width="20%">
			<col width="10%">
		</colgroup>
		<tr>
		   <th><p>거래처명</p></th>
		   <td><input type="text" name="s_cust_name" maxlength="100" style="width: 95%;"></td>
		   <th><p>사업자등록번호</p></th>
		   <td><input type="text" name="s_vendcd" maxlength="100" style="width: 90%;"></td>
		   <td align="right">
		   </td>
		</tr>
		<tr>
		    <td><p>계약일자</p></td>
		    <td>
		    	<input type="text" name="s_sdate" class="in_readonly" style="width: 100px;" maxlength="10" onkeyup="dateFormat(this)" onkeydown="num_only()" onkeypress="num_only()"/>
				<img src="../html/images/common/datepicker_icon.png" align="absmiddle" style="cursor:pointer" onClick="new CalendarFrame.Calendar(document.forms['form1']['s_sdate'])"> ~
				<input type="text" name="s_edate" class="in_readonly" style="width: 100px;" maxlength="10" onkeyup="dateFormat(this)" onkeydown="num_only()" onkeypress="num_only()"/>
				<img src="../html/images/common/datepicker_icon.png" align="absmiddle" style="cursor:pointer" onClick="new CalendarFrame.Calendar(document.forms['form1']['s_edate'])">
		    </td>
		    <th><p>담당자</p></th>
		    <td><input type="text" name="s_user_name" maxlength="100" style="width: 90%;">
		    </td>
		</tr>
		<tr>
		    <th><p>계약명</p></th>
		    <td><input type="text" name="s_cont_name" maxlength="100" style="width: 95%;"></td>
		    <th><p>계약구분</p></th>
		   	<td>
		   		<select name="s_cont_gubun">
		   			<option value="">-전체-</option>
		   			<option value="P">표준</option>
		   			<option value="B">자유계약</option>
		   			<option value="A">자동연장</option>
				</select>
		  	</td>
		  	<td align="right">
		      <button type="submit" class="search_btn">검색</button>
		    </td>
		</tr>
	</table>
</div>

<div style="width:100%" align="right">
	<button type="button" class="sbtn color2 ico-excel"onClick="document.forms['form1']['mode'].value='excel';document.forms['form1'].submit();"><span></span>엑셀</button>
</div>

<br/>

<div class="div_table">
	<table>
	
		<colgroup>
			<col width="13%">
		    <col>
		    <col width="7%">
		    <col width="12%">
		    <col width="15%">
	    	<col width="10%">
	    	<col width="8%">
		</colgroup>
		
		<tr>
		    <th>
				<a href="javascript:fChangeOrder('a.cont_userno', '{{sSortOrder}}')">
				계약번호
				<!-- IFC START 'sSortColumn==a.cont_userno' -->
					{{sSortCustNameIconName}}
				<!-- IFC END 'sSortColumn==a.cont_userno' -->
				<!-- IFC START 'sSortColumn!=a.cont_userno' -->
					<font style='color:blue;font-weight:bold'>↕</font>
				<!-- IFC END 'sSortColumn!=a.cont_userno' -->
				</a>
			</th>
		    <th>계약명</th>
		    <th>담당자</th>
		    <th>부서</th>
		    <th>거래처명</th>
		    <th>
				<a href="javascript:fChangeOrder('a.cont_date', '{{sSortOrder}}')">
				계약일자
				<!-- IFC START 'sSortColumn==a.cont_date' -->
					{{sSortCustNameIconName}}
				<!-- IFC END 'sSortColumn==a.cont_date' -->
				<!-- IFC START 'sSortColumn!=a.cont_date' -->
					<font style='color:blue;font-weight:bold'>↕</font>
				<!-- IFC END 'sSortColumn!=a.cont_date' -->
				</a>
			</th>
			<th>상태</th>
		</tr>
		
		<!-- IF START 'list' -->
			<!-- LOOP START 'list' -->
				<tr onMouseOver="this.style.backgroundColor='#EFEFEF'; return true" onMouseOut="this.style.backgroundColor=''; return true"
		    		onclick="location.href='{{list.link}}?cont_no={{list.cont_no}}&cont_chasu={{list.cont_chasu}}&{{list_query}}'" style="cursor:pointer">
					<td align="center">{{list.cont_userno}}</td>
					<td>
					<!-- IFC START 'list.auto_yn==Y' -->
					<img src="/web/buyer/html/images/common/i_contexp.gif" style="width:17px; height:17px; vertical-align: middle;" /> 
					<!-- IFC END 'list.auto_yn==Y' -->
					&nbsp;{{list.cont_name}}
					</td>
					<td align="center">{{list.user_name}}</td>
					<td align="center">{{list.division}}</td>
					<td align="center">{{list.cust_name}}</td>
					<td align="center">{{list.cont_date}}</td>
					<td align="center">{{list.status_nm}}</td>
		  		</tr>
			<!-- LOOP END 'list' -->
		<!-- IF END 'list' -->
		
		<!-- IFNOT START 'list' -->
			<tr>
				<td colspan="10" align="center">검색결과가 없습니다.</td>
		  	</tr>
		<!-- IFNOT END 'list' -->
		
	</table>
</div>

 </form>
{{form_script}}

<br/>
<div class="common-paging">{{pagerbar}}</div>

<iframe name="ifExcel" style="height:0; border: 0;"></iframe>
<script language="javascript">
function formSubmit(f){
	f['mode'].value="";
	return true;
}

// 정렬방식 변경
function fChangeOrder(sortColumn, sortOrder)
{
	var form = document.form1;
 
	form.hdn_sort_column.value = sortColumn;
    if (sortOrder == "asc") // 오름차순 정렬 일때
    {
        form.hdn_sort_order.value = "desc"; // 내림차순 정렬로 설정
    }
    else                        // 나머지 (내림차순 정렬 또는 최초 클릭시)
    {
        form.hdn_sort_order.value =  "asc";  // 오름차순 정렬로 설정
    }

    form.submit();

    return;
}

//거래처 코드 입력
function fPopCDKTH(cont_no, cont_chasu, cust_member_no)
{
	var	xpos  = event.x;
	var	ypos  = event.y + document.body.scrollTop;  // scroll 고려
	fLayerPopClose('agent_cd');
	fLayerPop('agent_cd', './pop_person_cd_KTH.jsp?cont_no='+cont_no+'&cont_chasu='+cont_chasu+'&cust_member_no='+cust_member_no, 400, 230, xpos, ypos);
}

//프로젝트 코드 입력
function fPopPJCD(cont_no, cont_chasu)
{
	var	xpos  = event.x;
	var	ypos  = event.y + document.body.scrollTop;  // scroll 고려
	fLayerPopClose('agent_cd');
	fLayerPop('agent_cd', './pop_project_cd.jsp?cont_no='+cont_no+'&cont_chasu='+cont_chasu, 400, 230, xpos, ypos);
}

function fAllCheck()
{
	var idx = document.getElementsByName("save").length; 

	for(var i=0; i<idx; i++){
		if(document.getElementsByName("all")[0].checked == true){
			document.getElementsByName("save")[i].checked = true;
		}else{
			document.getElementsByName("save")[i].checked = false;
		}
	}
	
}

function fSave()
{
	if($(":checkbox[name='save']:checked").length==0)
	{
		alert("다운로드할 계약을 먼저 선택해주세요.");
		return;
	}

	document.form1.target = "ifExcel";
	document.forms['form1']['mode'].value='down';
	document.forms['form1'].submit();
	document.form1.target = "_self";
}
</script>