<script language="javascript" type="text/javascript" src="/js/jquery/jquery-1.4.2.min.js"></script>
<form name="form1" method="get">
<div class="search_div">
<table class="search_table">
  <colgroup>
    <col width="20%"/>
    <col width="30%"/>
    <col width="50%"/>
  </colgroup>
  <tr>
    <th><p>상품코드</p></th>
    <td><input type="text" name="s_code" maxlength="30" style="width:95%"></td>
    <td align="right">
      <button type="submit" class="btn color ico-search"><span></span>검색</button>
      <button type="button" class="btn color ico-add" onclick="addCompany();"><span></span>선택</button>
    </td>
  </tr>
</table>
</div>
</form>
{{form_script}}


<form name="form2" method="get">
<div class="div_table">
<div class="util-row">
	<div class="push-left">
		<span class="caution-text">※상품코드를 입력후 검색 하세요.</span>
	</div>
</div>
<table>
	<colgroup>
		<col width="7%">
		<col width="15%">
		<col width="%">
		<col width="10%">
		<col width="10%">
		<col width="12%">
		<col width="12%">
		<col width="5%">
	</colgroup>
	<tr>
		<th><input type="checkbox" name="all" onClick="fAllCheck()"/></th>
		<th>프로모션명</th>
		<th>프로모션<br>일시</th>
		<th>구분</th>
		<th>주문매체</th>
		<th>홈쇼핑부담</th>
		<th>업체부담</th>
		<th>비고</th>
	</tr>
	<!-- LOOP START 'list' -->
	<tr>
		<td align="center" onclick="event.cancelBubble=true;"><input type="checkbox" name="save" value="{{list.__ord}}"/></td>
		<td align="center">{{list.promoName}}</td>
		<td align="center">{{list.promoBdate}}<br>~{{list.promoEdate}}</td>
		<td align="center">{{list.doTypeNM}}</td>
		<td align="center">{{list.orderMedia}}</td>
		<td align="center">{{list.ownCost}}</td>
		<td align="center">{{list.entpCost}}</td>
		<td align="center">{{list.remark}}
			<input type="hidden" name="goodsCode" value="{{list.goodsCode}}"/>
			<input type="hidden" name="promoNo" value="{{list.promoNo}}"/>
			<input type="hidden" name="promoName" value="{{list.promoName}}"/>
			<input type="hidden" name="promoBdate" value="{{list.promoBdate}}"/>
			<input type="hidden" name="promoEdate" value="{{list.promoEdate}}"/>
			<input type="hidden" name="flag" value="{{list.flag}}"/>
			<input type="hidden" name="doTypeNM" value="{{list.doTypeNM}}"/>
			<input type="hidden" name="doType" value="{{list.doType}}"/>
			<input type="hidden" name="orderMedia" value="{{list.orderMedia}}"/>
			<input type="hidden" name="ownCost" value="{{list.ownCost}}"/>
			<input type="hidden" name="entpCost" value="{{list.entpCost}}"/>
			<input type="hidden" name="cardName" value="{{list.cardName}}"/>
			<input type="hidden" name="remark" value="{{list.remark}}"/>
		</td>
	</tr>
	<!-- LOOP END 'list' -->
	<!-- IFNOT START 'list' -->
	<tr>
		<td align="center" colspan="5">조회 결과가 없습니다.</td>
	</tr>
<!-- IFNOT END 'list' -->
</table>


</form>

<script language="javascript">
attachOnload(function(){resizeTo(850,600)});
   function fAllCheck()
    {
        if($("input[name='all']").attr("checked"))  {
            $("input[name='save']").attr("checked",true);
        }else  {
            $("input[name='save']").attr("checked",false);
        }
    }

     function addCompany(){
        var f= document.forms['form2'];
        var arr;
        var chkCnt = $(":checkbox[name='save']:checked").length;

        if(chkCnt==0)  {
            alert("입력할 편성 정보를 선택 해주세요.");
            return;
        } else if($(":checkbox[name='save']").length==1) {
            $(":checkbox[name='save']").each(function() {
                if(this.checked) {
                    //alert(f['seqFrameNo'].value);
                    arr = new Array(
                        f['doTypeNM'].value
                        ,f['orderMedia'].value
                        ,f['ownCost'].value
                        ,f['entpCost'].value
                        ,f['remark'].value
                        ,f['goodsCode'].value
                        ,f['doType'].value
                        ,f['promoNo'].value
                    );
                }
            });
        } else {
            arr = new Array(chkCnt);
            $(":checkbox[name='save']").each(function() {
                if(this.checked) {
                    //alert(f['seqFrameNo'][this.value].value);
                    arr.push(new Array(
                        f['doTypeNM'][this.value].value
                        ,f['orderMedia'][this.value].value
                        ,f['entpCost'][this.value].value
                        ,f['ownCost'][this.value].value
                        ,f['remark'][this.value].value
                        ,f['goodsCode'][this.value].value
                        ,f['doType'][this.value].value
                        ,f['doType'][this.value].value
                        )
                    )
                }
            });

        }

        //console.log(arr);
        opener.addProitem(arr);
        self.close();
    }
</script>
