<form novalidate name="form1" method="post" onsubmit="return formSubmit(this);">

	<input type="hidden" name="asse_no" value="{{assessment.asse_no}}" >
	<input type="hidden" name="member_no" value="{{assessment.member_no}}" >
	<input type="hidden" name="save_div" value="0" >

	<div class="div_table">
		<div class="util-row">
			<div class="push-left">
				<h3>평가대상업체 등록<span class="caution-text"></span></h3>
			</div>
			<div class="push-right">
				평가상태: <span class="caution-text"><b>작성중</b></span>
			</div>
		</div>


		<table width="100%" border="0" cellspacing="0" cellpadding="0">
			<colgroup>
				<col width="12%">
				<col width="50%">
				<col width="10%">
				<col width="30%">
			</colgroup>
			<tr>
				<th class="req-check">업체명 </th>
				<td><input type="text" name="member_name" class="in_readonly" style="width:75%" value="{{assessment.member_name}}" required="Y" hname="업체명" readonly="readonly" >&nbsp;
					<button type="button" value="검색" class="sbtn ico-search" onclick="javascript:fPopupCustList()"><span></span>검색</button></td>
				<th class="req-check">평가년도 </th>
				<td>
					<select name="asse_year" style="width:80" required="Y" hname="평가년도" >
						<option value="">--선택--</option>
						<!-- LOOP START 'asse_year' -->
						<option value="{{asse_year.year}}">{{asse_year.year}}</option>
						<!-- LOOP END 'asse_year' -->
					</select>
				</td>
			</tr>
			<tr>
				<th class="req-check">프로젝트명</th>
				<td colspan="3"><input type="text" name="project_name" class="in_readonly" size="30" readOnly value="{{assessment.project_name}}" required="Y" hname="프로젝트명" >
					<button type="button" class="sbtn ico-search" value="선택" onClick="OpenWindows('../contract/project_list.jsp', 'project', '650', '560');"><span></span>선택</button>
				</td>
			</tr>
			<tr>
				<th class="req-check">평가종류</th>
				<td colspan="3">
					<select name="kind_cd" style="width:90" required="Y" hname="평가종류" onchange="divCdSetup()">
						<option value="">---선택---</option>
						<!-- LOOP START 'kind_cd' -->
						<option value="{{kind_cd.id}}">{{kind_cd.name}}</option>
						<!-- LOOP END 'kind_cd' -->
					</select>
				</td>
			</tr>
			<tr>
				<th class="req-check">평가부서 </th>
				<td colspan="3">
					<input type="checkbox" name="s_yn" value="Y" {{assessment.s_yn_check}} disabled/>구매팀&nbsp;
					<input type="checkbox" name="qc_yn" value="Y" {{assessment.qc_yn_check}} disabled/>Q.C팀&nbsp;
					<input type="checkbox" name="enc_yn" value="Y" {{assessment.enc_yn_check}} disabled/>ENC본부&nbsp;
					<input type="checkbox" name="f_yn" value="Y" {{assessment.f_yn_check}} disabled/>안전&nbsp;
				</td>
			</tr>
		</table>
	</div>
	<div class="btn-group-wrap">
		<!-- IFNOT START 'modify' -->
		<button type="button" class="btn color ico-save" onclick="save('0');"><span></span>저장</button>
		<button type="button" class="btn color ico-list" onclick="location.href='assessment_list.jsp?{{list_query}}'"><span></span>목록으로</button>
		<!-- IFNOT END 'modify' -->
		<!-- IF START 'modify' -->
		<button type="button"  class="btn color ico-delete" onclick="if(confirm('삭제 하시겠습니까?')){location.href='assessment_delete.jsp?asse_no={{assessment.asse_no}}'}"><span></span>삭제</button>
		<button type="button"  class="btn color ico-save" onclick="save('0');"><span></span>저장</button>
		<button type="button"  class="btn color ico-confirm" onclick="save('1');"><span></span>평가시작</button>
		<button type="button"  class="btn color ico-list" onclick="location.href='assessment_list.jsp?{{list_query}}'"><span></span>목록으로</button>
		<!-- IF END 'modify' -->
	</div>
</form>
{{form_script}}
<script language="javascript">

    function formSubmit(f){
        var f = document.forms['form1'];

        if(validate(f)){
            if(f['qc_yn'].checked == false && f['enc_yn'].checked == false && f['s_yn'].checked == false && f['f_yn'].checked == false){
                alert("평가부서를 선택해주세요.");
                return false;
            }

            var message = "저장 하시겠습니까?";
            if(f['save_div'].value == "1"){
                message = "평가시작 하시겠습니까?";
                f.submit();
            }
            if(confirm(message)){
                return true;
            }
        }
        return false;
    }
    function save(div){

        var f = document.forms['form1'];
        f['save_div'].value = div;
        if(validate(f)){
            if(f['qc_yn'].checked == false && f['enc_yn'].checked == false && f['s_yn'].checked == false && f['f_yn'].checked == false){
                alert("평가부서를 선택해주세요.");
                return false;
            }
            var message = "저장 하시겠습니까?";
            if(f['save_div'].value == "1"){
                message = "평가시작 하시겠습니까?";
            }
            if(confirm(message)){
                f.submit();
            }
        }
        return;

    }

    //현장선택
    function fSelProject(result)
    {
        var form = document.form1;
        if (result != null)
        {
            form.project_name.value = result[1];
        }
    }

    //업체명 검색 팝업
    function fPopupCustList(){
        OpenWindows('pop_cust_list.jsp','pop_search_comapny', '450','650');
    }
    //업체명 리턴값 처리
    function fPopupCustListResult(result){

        if(result!=null){
            var i =0;
            var form_name = "form1";
            SetFormValue(form_name,"member_no",result[i++]);
            SetFormValue(form_name,"member_name",result[i++]);
        }
    }
    //평가종류 변경 이벤트
    function divCdSetup(){
        var f = document.forms['form1'];
        var kind_cd = f['kind_cd'].value;
        if(kind_cd == "N" || kind_cd == "R"){
            f['qc_yn'].disabled = true;
            f['qc_yn'].checked = false;
            f['enc_yn'].disabled = true;
            f['enc_yn'].checked = false;
            f['f_yn'].disabled = true;
            f['f_yn'].checked = false;
            f['s_yn'].disabled = false;
            f['s_yn'].checked = true;
        }else if(kind_cd == "S"){
            f['qc_yn'].disabled = false;
            f['enc_yn'].disabled = false;
            f['f_yn'].disabled = false;
            f['s_yn'].disabled = true;
            f['s_yn'].checked = false;
        }else{
            f['qc_yn'].disabled = true;
            f['qc_yn'].checked = false;
            f['enc_yn'].disabled = true;
            f['enc_yn'].checked = false;
            f['s_yn'].disabled = true;
            f['s_yn'].checked = false;
            f['f_yn'].disabled = true;
            f['f_yn'].checked = false;
        }
    }
    divCdSetup();
</script>
