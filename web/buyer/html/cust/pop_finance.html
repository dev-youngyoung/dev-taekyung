<form novalidate name="form1" method="post" enctype="multipart/form-data" action="financeUpdate.jsp">
	<input type="hidden" name="print_content">
	<input type="hidden" name="asse_no" value="{{assessment.asse_no}}" >
	<input type="hidden" name="div_cd" value="{{assessment.div_cd}}" >

<div class="cont_warp">	
	<style type="text/css" id="__html_style">
	.glabel {
		color: #707070;
		FONT-FAMILY: "돋움", "Arial";
		FONT-SIZE: 9pt;
		/*LINE-HEIGHT: 13pt;*/
		border: 1px solid;
		border-color: #d7d5ca;
		text-align: left;
		background-color: #ffff00
	}
	td {  font-family: "나눔고딕, Arial"; font-size:12px; font-style: normal; letter-spacing:0; color: black;line-height:150%}
	.lineTable { border-collapse:collapse; border:1px solid black }
	.lineTable td { border:1px solid black }
	.lineTable .noborder { border:0 }
	.itemtable {font-size: 11px;line-height:180%;background-color:white;}
	</style>
	<div id="__html">
		<div style="padding-top: 10px" id="__html_0">
			{{assessment.asse_subhtml}}
		</div>
	</div>
</div>			
</form>
<div class="btn-group-wrap">
	<!-- IF START 'modify' -->
	<button type="button" class="btn color ico-save" onclick="save()" ><span></span>저장</button>
	<button type="button" class="btn color ico-print" onclick="print()"><span></span>인쇄</button>
	<button type="button" class="btn color ico-list" onclick="javascript:window.close();"><span></span>닫기</button>
	<!-- IF END 'modify' -->
	<!-- IFNOT START 'modify' -->
	<button type="button" class="btn color ico-print" onclick="print()"><span></span>인쇄</button>
	<button type="button" class="btn color ico-list" onclick="javascript:window.close();"><span></span>닫기</button>
	<!-- IFNOT END 'modify' -->
</div>

<script type="text/javascript">

window.resizeTo(1000,600);

var hexDigits = new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"); 

function hex(x) {
  return isNaN(x) ? "00" : hexDigits[(x - x % 16) / 16] + hexDigits[x % 16];
}

//선택안한 항목이 있는지 Check
function selectCheck(){

	for(var i=1; i<5; i++){	//행
		var checkYn = "n";
		for(var j=1; j<=5; j++){	//열
			var checkItem = $("#operationitem"+i+"_"+j).css("background-color");
            if(checkItem == "yellow" || checkItem == "rgb(255, 255, 0)"){
                checkYn = "y";
                break;
           }
		}
		if(checkYn == "n"){
			alert("평가항목을 모두 선택해주세요");
			return false;
		}
	}
	return true;
}

function calculation(){
	
	<!-- IFNOT START 'rtype' -->
	var rcnt = 8;
	<!-- IFNOT END 'rtype' -->
	<!-- IF START 'rtype' -->
	var rcnt = 5;
	<!-- IF END 'rtype' -->
	
	//수익성 계산
	calcProfitability(rcnt);

	//안전성 계산
	calcSafety(rcnt);

	//활동성 계산
	calcActivity(rcnt);

	//지구력 계산
	calcEndurance(rcnt);

	<!-- IFNOT START 'rtype' -->
	//성장성 계산
	calcGrowth(rcnt);
	<!-- IFNOT END 'rtype' -->
	
	//종합 계산
	calcTotal(rcnt);
}

function calcProfitability(rcnt){
	//수익성 = 매출액 / (총비용 매출원가 + 총비용 판매와관리비)
	var sales1 = $("#sales1").val().replace(/,/g, '');
	var sales2 = $("#sales2").val().replace(/,/g, '');
	var sales3 = $("#sales3").val().replace(/,/g, '');

	var cost1 = $("#cost1").val().replace(/,/g, '');
	var cost2 = $("#cost2").val().replace(/,/g, '');
	var cost3 = $("#cost3").val().replace(/,/g, '');

	var mCost1 = $("#mCost1").val().replace(/,/g, '');
	var mCost2 = $("#mCost2").val().replace(/,/g, '');
	var mCost3 = $("#mCost3").val().replace(/,/g, '');

	var tCost1 = Number(cost1) + Number(mCost1);
	var tCost2 = Number(cost2) + Number(mCost2);
	var tCost3 = Number(cost3) + Number(mCost3);

	var profitabilityPoint1 = Number(sales1) / Number(tCost1);
	if(isFinite(profitabilityPoint1)){
		$("#profitabilityPoint1").html(profitabilityPoint1.toFixed(3));
		var profitabilityRating1 = "양호";
		if(profitabilityPoint1.toFixed(2) > 1.5){
			profitabilityRating1 = "우수";
		}else if(profitabilityPoint1.toFixed(2) < 0.8){
			profitabilityRating1 = "저조";
		}
		$("#profitabilityRating1").html(profitabilityRating1);
	}
	var profitabilityPoint2 = Number(sales2) / Number(tCost2);
	if(isFinite(profitabilityPoint2)){
		$("#profitabilityPoint2").html(profitabilityPoint2.toFixed(3));
		var profitabilityRating2 = "양호";
		if(profitabilityPoint2.toFixed(2) > 1.5){
			profitabilityRating2 = "우수";
		}else if(profitabilityPoint2.toFixed(2) < 0.8){
			profitabilityRating2 = "저조";
		}
		$("#profitabilityRating2").html(profitabilityRating2);
	}
	var profitabilityPoint3 = Number(sales3) / Number(tCost3);
	if(isFinite(profitabilityPoint3)){
		$("#profitabilityPoint3").html(profitabilityPoint3.toFixed(3));
		var profitabilityRating3 = "양호";
		if(profitabilityPoint3.toFixed(2) > 1.5){
			profitabilityRating3 = "우수";
		}else if(profitabilityPoint3.toFixed(2) < 0.8){
			profitabilityRating3 = "저조";
		}
		$("#profitabilityRating3").html(profitabilityRating3);
	}
	
	for(var i=1; i<6; i ++){
		$("#operationitem1_"+i).css("background-color","white");	
	}
	if(profitabilityPoint1 >= 1.4){
		$("#operationitem1_1").css("background-color","yellow");
		$("#operationitem1").html(5.0);
	}else if(1.0 <= profitabilityPoint1 && profitabilityPoint1 < 1.4){
		$("#operationitem1_2").css("background-color","yellow");
		$("#operationitem1").html(4.0);
	}else if(0.8 <= profitabilityPoint1 && profitabilityPoint1 < 1.0){
		$("#operationitem1_3").css("background-color","yellow");
		$("#operationitem1").html(3.0);
	}else if(0.5 <= profitabilityPoint1 && profitabilityPoint1 < 0.8){
		$("#operationitem1_4").css("background-color","yellow");
		$("#operationitem1").html(2.0);
	}else{
		$("#operationitem1_5").css("background-color","yellow");
		$("#operationitem1").html(1.0);
	}
	sumSafetyItemPoint("operationitem", rcnt);
	culRatingPoint();
}

function calcSafety(rcnt){
	//안전성 = 유동자산 / 총부채
	var currentAssets1 = $("#currentAssets1").val().replace(/,/g, '');
	var currentAssets2 = $("#currentAssets2").val().replace(/,/g, '');
	var currentAssets3 = $("#currentAssets3").val().replace(/,/g, '');
	
	var liabilities1 = $("#liabilities1").val().replace(/,/g, '');
	var liabilities2 = $("#liabilities2").val().replace(/,/g, '');
	var liabilities3 = $("#liabilities3").val().replace(/,/g, '');

	var safetyPoint1 = Number(currentAssets1) / Number(liabilities1);
	if(isFinite(safetyPoint1)){
		$("#safetyPoint1").html(safetyPoint1.toFixed(3));
		var safetyRating1 = "양호";
		if(safetyPoint1.toFixed(2) > 1.5){
			safetyRating1 = "우수";
		}else if(safetyPoint1.toFixed(2) < 0.8){
			safetyRating1 = "저조";
		}
		$("#safetyRating1").html(safetyRating1);
	}

	var safetyPoint2 = Number(currentAssets2) / Number(liabilities2);
	if(isFinite(safetyPoint2)){
		$("#safetyPoint2").html(safetyPoint2.toFixed(3));
		var safetyRating2 = "양호";
		if(safetyPoint2.toFixed(2) > 1.5){
			safetyRating2 = "우수";
		}else if(safetyPoint2.toFixed(2) < 0.8){
			safetyRating2 = "저조";
		}
		$("#safetyRating2").html(safetyRating2);
	}

	var safetyPoint3 = Number(currentAssets3) / Number(liabilities3);
	if(isFinite(safetyPoint3)){
		$("#safetyPoint3").html(safetyPoint3.toFixed(3));
		var safetyRating3 = "양호";
		if(safetyPoint3.toFixed(2) > 1.5){
			safetyRating3 = "우수";
		}else if(safetyPoint3.toFixed(2) < 0.8){
			safetyRating3 = "저조";
		}
		$("#safetyRating3").html(safetyRating3);
	}
	
	for(var i=1; i<6; i ++){
		$("#operationitem2_"+i).css("background-color","white");	
	}
	if(safetyPoint1 >= 1.4){
		$("#operationitem2_1").css("background-color","yellow");
		$("#operationitem2").html(5.0);
	}else if(1.0 <= safetyPoint1 && safetyPoint1 < 1.4){
		$("#operationitem2_2").css("background-color","yellow");
		$("#operationitem2").html(4.0);
	}else if(0.8 <= safetyPoint1 && safetyPoint1 < 1.0){
		$("#operationitem2_3").css("background-color","yellow");
		$("#operationitem2").html(3.0);
	}else if(0.5 <= safetyPoint1 && safetyPoint1 < 0.8){
		$("#operationitem2_4").css("background-color","yellow");
		$("#operationitem2").html(2.0);
	}else{
		$("#operationitem2_5").css("background-color","yellow");
		$("#operationitem2").html(1.0);
	}
	sumSafetyItemPoint("operationitem", rcnt);
	culRatingPoint();
}

function calcActivity(rcnt){
	//활동성 = 매출액 / 총자산
	var sales1 = $("#sales1").val().replace(/,/g, '');
	var sales2 = $("#sales2").val().replace(/,/g, '');
	var sales3 = $("#sales3").val().replace(/,/g, '');
	
	var assets1 = $("#assets1").val().replace(/,/g, '');
	var assets2 = $("#assets2").val().replace(/,/g, '');
	var assets3 = $("#assets3").val().replace(/,/g, '');

	var activityPoint1 = Number(sales1) / Number(assets1);
	if(isFinite(activityPoint1)){
		$("#activityPoint1").html(activityPoint1.toFixed(3));
		var activityRating1 = "양호";
		if(activityPoint1.toFixed(2) > 1.5){
			activityRating1 = "우수";
		}else if(activityPoint1.toFixed(2) < 0.8){
			activityRating1 = "저조";
		}
		$("#activityRating1").html(activityRating1);
	}

	var activityPoint2 = Number(sales2) / Number(assets2);
	if(isFinite(activityPoint2)){
		$("#activityPoint2").html(activityPoint2.toFixed(3));
		var activityRating2 = "양호";
		if(activityPoint2.toFixed(2) > 1.5){
			activityRating2 = "우수";
		}else if(activityPoint2.toFixed(2) < 0.8){
			activityRating2 = "저조";
		}
		$("#activityRating2").html(activityRating2);
	}

	var activityPoint3 = Number(sales3) / Number(assets3);
	if(isFinite(activityPoint3)){
		$("#activityPoint3").html(activityPoint3.toFixed(3));
		var activityRating3 = "양호";
		if(activityPoint3.toFixed(2) > 1.5){
			activityRating3 = "우수";
		}else if(activityPoint3.toFixed(2) < 0.8){
			activityRating3 = "저조";
		}
		$("#activityRating3").html(activityRating3);
	}
	
	for(var i=1; i<6; i ++){
		$("#operationitem3_"+i).css("background-color","white");	
	}
	if(activityPoint1 >= 1.4){
		$("#operationitem3_1").css("background-color","yellow");
		$("#operationitem3").html(5.0);
	}else if(1.0 <= activityPoint1 && activityPoint1 < 1.4){
		$("#operationitem3_2").css("background-color","yellow");
		$("#operationitem3").html(4.0);
	}else if(0.8 <= activityPoint1 && activityPoint1 < 1.0){
		$("#operationitem3_3").css("background-color","yellow");
		$("#operationitem3").html(3.0);
	}else if(0.5 <= activityPoint1 && activityPoint1 < 0.8){
		$("#operationitem3_4").css("background-color","yellow");
		$("#operationitem3").html(2.0);
	}else{
		$("#operationitem3_5").css("background-color","yellow");
		$("#operationitem3").html(1.0);
	}
	sumSafetyItemPoint("operationitem", rcnt);
	culRatingPoint();
}

function calcEndurance(rcnt){
	//지구력 = 총자본 / 총부채
	var capital1 = $("#capital1").val().replace(/,/g, '');
	var capital2 = $("#capital2").val().replace(/,/g, '');
	var capital3 = $("#capital3").val().replace(/,/g, '');

	var liabilities1 = $("#liabilities1").val().replace(/,/g, '');
	var liabilities2 = $("#liabilities2").val().replace(/,/g, '');
	var liabilities3 = $("#liabilities3").val().replace(/,/g, '');

	var endurancePoint1 = Number(capital1) / Number(liabilities1);
	if(isFinite(endurancePoint1)){
		$("#endurancePoint1").html(endurancePoint1.toFixed(3));
		var enduranceRating1 = "양호";
		if(endurancePoint1.toFixed(2) > 1.5){
			enduranceRating1 = "우수";
		}else if(endurancePoint1.toFixed(2) < 0.8){
			enduranceRating1 = "저조";
		}
		$("#enduranceRating1").html(enduranceRating1);
	}

	var endurancePoint2 = Number(capital2) / Number(liabilities2);
	if(isFinite(endurancePoint2)){
		$("#endurancePoint2").html(endurancePoint2.toFixed(3));
		var enduranceRating2 = "양호";
		if(endurancePoint2.toFixed(2) > 1.5){
			enduranceRating2 = "우수";
		}else if(endurancePoint2.toFixed(2) < 0.8){
			enduranceRating2 = "저조";
		}
		$("#enduranceRating2").html(enduranceRating2);
	}

	var endurancePoint3 = Number(capital3) / Number(liabilities3);
	if(isFinite(endurancePoint3)){
		$("#endurancePoint3").html(endurancePoint3.toFixed(3));
		var enduranceRating3 = "양호";
		if(endurancePoint3.toFixed(2) > 1.5){
			enduranceRating3 = "우수";
		}else if(endurancePoint3.toFixed(2) < 0.8){
			enduranceRating3 = "저조";
		}
		$("#enduranceRating3").html(enduranceRating3);
	}
	
	for(var i=1; i<6; i ++){
		$("#operationitem4_"+i).css("background-color","white");	
	}
	if(endurancePoint1 >= 1.4){
		$("#operationitem4_1").css("background-color","yellow");
		$("#operationitem4").html(5.0);
	}else if(1.0 <= endurancePoint1 && endurancePoint1 < 1.4){
		$("#operationitem4_2").css("background-color","yellow");
		$("#operationitem4").html(4.0);
	}else if(0.8 <= endurancePoint1 && endurancePoint1 < 1.0){
		$("#operationitem4_3").css("background-color","yellow");
		$("#operationitem4").html(3.0);
	}else if(0.5 <= endurancePoint1 && endurancePoint1 < 0.8){
		$("#operationitem4_4").css("background-color","yellow");
		$("#operationitem4").html(2.0);
	}else{
		$("#operationitem4_5").css("background-color","yellow");
		$("#operationitem4").html(1.0);
	}
	sumSafetyItemPoint("operationitem", rcnt);
	culRatingPoint();

}

function calcGrowth(rcnt){
	//성장성 = 총자본 / (총자본 - 당기순이익)

	var capital1 = $("#capital1").val().replace(/,/g, '');
	var capital2 = $("#capital2").val().replace(/,/g, '');
	var capital3 = $("#capital3").val().replace(/,/g, '');
	
	var capital1_1 = $("#capital1").val().replace(/,/g, '');
	var capital2_1 = $("#capital2").val().replace(/,/g, '');
	var capital3_1 = $("#capital3").val().replace(/,/g, '');

	var netIncome1 = $("#netIncome1").val().replace(/,/g, '');
	var netIncome2 = $("#netIncome2").val().replace(/,/g, '');
	var netIncome3 = $("#netIncome3").val().replace(/,/g, '');

	var growthPoint1 = Number(capital1) / ( Number(capital1_1) - Number(netIncome1) );
	if(isFinite(growthPoint1)){
		$("#growthPoint1").html(growthPoint1.toFixed(3));
		var growthRating1 = "양호";
		if(growthPoint1.toFixed(2) > 1.5){
			growthRating1 = "우수";
		}else if(growthPoint1.toFixed(2) < 0.8){
			growthRating1 = "저조";
		}
		$("#growthRating1").html(growthRating1);
	}
	var growthPoint2 = Number(capital2) / ( Number(capital2_1) - Number(netIncome2) );
	if(isFinite(growthPoint2)){
		$("#growthPoint2").html(growthPoint2.toFixed(3));
		var growthRating2 = "양호";
		if(growthPoint2.toFixed(2) > 1.5){
			growthRating2 = "우수";
		}else if(growthPoint2.toFixed(2) < 0.8){
			growthRating2 = "저조";
		}
		$("#growthRating2").html(growthRating2);
	}
	var growthPoint3 = Number(capital3) / ( Number(capital3_1) - Number(netIncome3) );
	if(isFinite(growthPoint3)){
		$("#growthPoint3").html(growthPoint3.toFixed(3));
		var growthRating3 = "양호";
		if(growthPoint3.toFixed(2) > 1.5){
			growthRating3 = "우수";
		}else if(growthPoint3.toFixed(2) < 0.8){
			growthRating3 = "저조";
		}
		$("#growthRating3").html(growthRating3);
	}
	
	for(var i=1; i<6; i ++){
		$("#operationitem5_"+i).css("background-color","white");	
	}
	if(growthPoint1 >= 1.4){
		$("#operationitem5_1").css("background-color","yellow");
		$("#operationitem5").html(5.0);
	}else if(1.0 <= growthPoint1 && growthPoint1 < 1.4){
		$("#operationitem5_2").css("background-color","yellow");
		$("#operationitem5").html(4.0);
	}else if(0.8 <= growthPoint1 && growthPoint1 < 1.0){
		$("#operationitem5_3").css("background-color","yellow");
		$("#operationitem5").html(3.0);
	}else if(0.5 <= growthPoint1 && growthPoint1 < 0.8){
		$("#operationitem5_4").css("background-color","yellow");
		$("#operationitem5").html(2.0);
	}else{
		$("#operationitem5_5").css("background-color","yellow");
		$("#operationitem5").html(1.0);
	}
	sumSafetyItemPoint("operationitem", rcnt);
	culRatingPoint();

}

function calcTotal(rcnt){
	//종합 = (수익성 + 안전성 + 활동성 + 지구력) / 5
	var profitabilityPoint1 = $("#profitabilityPoint1").html();
	var profitabilityPoint2 = $("#profitabilityPoint2").html();
	var profitabilityPoint3 = $("#profitabilityPoint3").html();

	var safetyPoint1 = $("#safetyPoint1").html();
	var safetyPoint2 = $("#safetyPoint2").html();
	var safetyPoint3 = $("#safetyPoint3").html();

	var activityPoint1 = $("#activityPoint1").html();
	var activityPoint2 = $("#activityPoint2").html();
	var activityPoint3 = $("#activityPoint3").html();

	var endurancePoint1 = $("#endurancePoint1").html();
	var endurancePoint2 = $("#endurancePoint2").html();
	var endurancePoint3 = $("#endurancePoint3").html();

	//var growthPoint1 = $("#growthPoint1").html();
	//var growthPoint2 = $("#growthPoint2").html();
	//var growthPoint3 = $("#growthPoint3").html();
	
	var tPoint1 = (parseFloat(profitabilityPoint1) + parseFloat(safetyPoint1) + parseFloat(activityPoint1) + parseFloat(endurancePoint1)) / 4
	
	if(isFinite(tPoint1)){
		$("#totalPoint1").html(tPoint1.toFixed(3));
	}
	var tPoint2 = (parseFloat(profitabilityPoint2) + parseFloat(safetyPoint2) + parseFloat(activityPoint2) + parseFloat(endurancePoint2)) / 4
	if(isFinite(tPoint2)){
		$("#totalPoint2").html(tPoint2.toFixed(3));
	}
	var tPoint3 = (parseFloat(profitabilityPoint3) + parseFloat(safetyPoint3) + parseFloat(activityPoint3) + parseFloat(endurancePoint3)) / 4
	if(isFinite(tPoint3)){
		$("#totalPoint3").html(tPoint3.toFixed(3));
	}
	
	for(var i=1; i<6; i ++){
		$("#operationitem6_"+i).css("background-color","white");	
	}
	if(tPoint1 >= 1.4){
		$("#operationitem6_1").css("background-color","yellow");
		$("#operationitem6").html(5.0);
	}else if(1.0 <= tPoint1 && tPoint1 < 1.4){
		$("#operationitem6_2").css("background-color","yellow");
		$("#operationitem6").html(4.0);
	}else if(0.8 <= tPoint1 && tPoint1 < 1.0){
		$("#operationitem6_3").css("background-color","yellow");
		$("#operationitem6").html(3.0);
	}else if(0.5 <= tPoint1 && tPoint1 < 0.8){
		$("#operationitem6_4").css("background-color","yellow");
		$("#operationitem6").html(2.0);
	}else{
		$("#operationitem6_5").css("background-color","yellow");
		$("#operationitem6").html(1.0);
	}
	sumSafetyItemPoint("operationitem", rcnt);
	culRatingPoint();
}

function onItemSet(obj, sheetId){

	
	<!-- IFNOT START 'rtype' -->
	var rcnt = 8;
	<!-- IFNOT END 'rtype' -->
	<!-- IF START 'rtype' -->
	var rcnt = 5;
	<!-- IF END 'rtype' -->
	
	<!-- IF START 'modify' -->
	var itemPoint = 0;
	var onClickCurId = $(obj).attr("id");
	var arryItem = onClickCurId.split("_");
	var itemId = arryItem[0];
	var itemSeq = arryItem[1];
	for(var i=1; i<6; i ++){
		$("#"+itemId+"_"+i).css("background-color","white");	
	}

	$(obj).css("background-color","yellow");
	if(itemSeq == "1"){
		itemPoint = 5.0;
	}else if(itemSeq == "2"){
		itemPoint = 4.0;
	}else if(itemSeq == "3"){
		itemPoint = 3.0;
	}else if(itemSeq == "4"){
		itemPoint = 2.0;
	}else{
		itemPoint = 1.0;
	}
	
	$("#"+itemId).html(itemPoint);	//평점
	var sheetNm = "";
	var rowCnt = 0;
	if(sheetId == "1"){
		sheetNm = "operationitem";
		rowCnt = rcnt;
	}
	sumSafetyItemPoint(sheetNm, rowCnt);
	culRatingPoint();
	<!-- IF END 'modify' -->
}

function sumSafetyItemPoint(sheetNm, rowCnt){
	
	var sumPoint = 0;
	for(var i=1; i<rowCnt; i++){
		sumPoint = sumPoint + parseFloat($("#"+sheetNm+i).html());	//항목평가 점수
	}
	$("#"+sheetNm+"SumPoint").html(sumPoint.toFixed(1));	
}

function culRatingPoint(){
	
	var totalPoitn = 0;	//최종점수
	var totalRating = 0;
	var operationSumPoint = parseFloat($("#operationitemSumPoint").html());		//안전시트의 최종판정 점수
	totalPoitn = operationSumPoint;		//합산(최종점수)

	$("#rating").val(totalPoitn.toFixed(1));
	$("#point").val(totalPoitn.toFixed(1));
	$("#totalPoint").html(totalPoitn.toFixed(1));
}



function returnTotalPoint(){
	if(selectCheck()){
		window.returnValue = $("#point").val();
		window.close();
	}
}


function save(){

	var f = document.forms['form1'];
	if(selectCheck()){
		if(validate(f)){
			<!-- IF START 'rtype' -->
			var d = f['createDate'].value;
		    if(!isDateFormat(d)) {
		    	alert("YYYY-MM-DD 작성일을 확인해주세요.");
		    	f['createDate'].focus();
		        return false;
		    }
		    <!-- IF END 'rtype' -->
			var d = f['ratingDate'].value;
		    if(!isDateFormat(d)) {
		    	alert("YYYY-MM-DD 평가일을 확인해주세요.");
		    	f['ratingDate'].focus();
		        return false;
		    }
		    
			if(confirm("저장 하시겠습니까?")){
                setDivInputValue("__html");
				splitHtml(f, 'doc_html', false);
				f.submit();
			}
		}
	}
}

function isDateFormat(d) {
    var df = /[0-9]{4}-[0-9]{2}-[0-9]{2}/;
    return d.match(df);
}

function print(){
	alert('배경색을 인쇄하려면 브라우저의 [파일] -> [페이지 설정] 메뉴에서 "배경색 및 이미지 인쇄"를 체크해주세요."');
	var f = document.forms['form1'];
	removeInput(document.getElementById("__html_0"), f['print_content']);
	var printPop = window.open("","_blank","width=748, height=700");
	var html = "<html><head>"+$('head').html()+"<style type='text/css'>"+$("#__html_style").html()+"</style></head><body>"+ f['print_content'].value+"</body></html>"
	printPop.document.write(html);
	
	printPop.document.close();
	printPop.print();
	//printPop.close();
}

<!-- IF START 'modify' -->
SetFormValue("form1","createDate","{{cur_date}}");
SetFormValue("form1","ratingDate","{{cur_date}}");
<!-- IF END 'modify' -->
</script> 