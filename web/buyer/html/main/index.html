<link rel="stylesheet" type="text/css" href="../html/css/layout.css?sysdate={{_sysdate}}">

<!-- 전자인증 모듈 설정 //-->
<!-- INCLUDE FILE 'layout/crosscert_include.html' -->
<!-- 전자인증 모듈 설정 //-->

<div class="login_wrap">
    <div class="login_inner">
        <h1>농심</h1>
        <form name="form1" action="{{loginurl}}" method="post" onSubmit="return false">
        <div class="login_box">        
            <div class="login_left">
                <h2>전자계약시스템</h2>
                <span>Electronic Contract System</span>
                <div class="CS_guide">
                    <p>공인인증서 발급문의</p>
                    <p>한국무역정보 1566-5950(영업부문)<br> 
                                                    한국전자인증 1566-0566(영업부문 외)</p>
                    <p></p>
                    <p>평일 : 오전 9시 ~ 오후 6시<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( * 점심시간 : 12시 ~ 13시 )</p>
                </div>
                <ul class="go_link2">
                    <li><a href="javascript:fTradesignUrl()">공인인증서 안내(한국무역정보)</a></li>
                    <li><a href="javascript:fCrosscerUrl()">공인인증서 안내(한국전자인증)</a></li>
                </ul>
                <ul class="go_link">
                    <li><a href="/FileDownLoad?FILE_KEY=file.path.pds&FILE_NAME=manual.ppt" download="사용자매뉴얼.pptx">사용자 매뉴얼</a></li>
                    <li><a href="javascript:OpenWindow('/web/buyer/html/layout/policy.html', 'policy', 1200, 800);">이용약관</a></li>
                    <li><a href="javascript:OpenWindow('/web/buyer/html/layout/privacy.html', 'policy', 1200, 800);">개인정보처리방침</a></li>
                </ul>
				<!-- 임시 SSO 로그인 적용 start -->
				<!-- 
				<ul>
                    <li><a href="#">임시 SSO로그인 &nbsp;&nbsp;☞&nbsp;&nbsp;&nbsp;&nbsp;<input type="text" id="sso_id" name="sso_id" class="id" style="width:130px;" maxlength="10" placeholder="사번입력" onkeydown="if(event.keyCode==13){event.preventDefault();ssoSign();}">&nbsp;&nbsp;<button type="button" onclick="ssoSign()">클릭</button></a></li>
                </ul>
                 -->
                <!-- 임시 SSO 로그인 적용 end -->
                
            </div>

            <div class="login_right">
                <h2>Member Login</h2>
                <div class="tab">
                    <button class="tablinks" onclick="openLogin(event, 'typeA')">인증서로그인</button>
                    <button class="tablinks" onclick="openLogin(event, 'typeB')" id="defaultOpen">비밀번호 로그인</button>
                </div>
                <!--인증서 로그인-->
                <div id="typeA" class="tabcontent">
                  <ul>
                      <li><input type="text" id="vendCd" name="vendCd" class="id" maxlength="10" placeholder="사업자등록번호를 입력하세요"></li>
                      <li><a href="javascript:fSign();" class="btn_login">로그인</a></li>
                      <li><a href="../member/join_agree.jsp" class="btn_join">회원가입</a></li>
                  </ul>
                  <p class="find_link" style="margin-top: 70px;">
                      <a href="../member/find_id.jsp">아이디 찾기</a>
                      <a href="../member/find_pw.jsp">비밀번호 찾기</a>
                  </p>
                </div>
                <!--비밀번호 로그인-->
                <div id="typeB" class="tabcontent" style="display:none">
                  <ul>
                      <li><input type="text" name="user_id" value="{{user_id}}" maxlength="20" class="id" placeholder="아이디를 입력하세요" style="ime-mode:disabled"></li>
                      <li><input type="password" name="passwd" maxlength="20" class="pw" placeholder="비밀번호를 입력하세요" onkeydown="if(event.keyCode==13){event.preventDefault();fLogin();}" ></li>
                      <li><a href="javascript:fLogin();" class="btn_login">로그인</a></li>
                      <!-- <li><button type="button" class="login-input-btn" onclick="fLogin()">로그인</button></li> -->
                      <li><a href="../member/join_agree.jsp" class="btn_join">회원가입</a></li>
                      <iframe name="login_ifrm" src="about:blank" width="0" height="0" frameborder="0" style="display: none"></iframe>
                      <!-- <div id="loading" style="position:absolute;left:100px;top:70px;display:none"><img src="../html/images/common/loading.gif"></div> -->
                  </ul>
                  <p class="find_link">
                      <a href="../member/find_id.jsp">아이디 찾기</a>
                      <a href="../member/find_pw.jsp">비밀번호 찾기</a>
                  </p>
                  <!-- 메인페이지 : 최초1회 ~ 부분 등록에 따른 추가 -->
                  <p class="certify"><b><font color="blue"> * 최초 1회 회원가입으로 ID/PWD를 발급하여 ID로 로그인 및 <br>&nbsp;&nbsp;&nbsp;인증서등록 후 사용해야 합니다.</font> </b></p>
                </div>
            </div>
        </div>
        </form>
    </div>
    <div class="footer-cont">
        <p>
            <span class="name">(주)농심</span>
            <span>서울특별시 동작구 여의대방로 112(신대방동)</span>
            <span>사업자등록번호 118-81-03914</span>
            <span>대표이사 박준</span>
            <span>대표전화 02.820.7114</span>
		<!-- <span>고객센터 080.023.5181</span> -->
        </p>
        <p>©  NONGSHIM CO.,LTD. ALL RIGHTS RESERVED.</p>
    </div>
</div>
<script>
function openLogin(evt, loginType) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(loginType).style.display = "block";
    evt.currentTarget.className += " active";
}

// Get the element with id="defaultOpen" and click on it
document.getElementById("defaultOpen").click();
</script>

<script>
function ssoSign(){
	var f = document.forms['form1'];
	var ssoId = null;
	var url = null;
	
	ssoId = f['sso_id'].value;
	if (ssoId == null || ssoId.length == 0) {
		alert("사번을 입력해주세요.");
		return;
	}	
	url = "/web/buyer/main/loginSSO.jsp?user_id=" + ssoId;
	location.href=url;
}
function fLogin(){
	var f = document.forms['form1'];
	if (f['user_id'].value=="") {
		f['user_id'].focus();
		alert("아이디를 입력 하세요.");
		return;
	}
	if (f['passwd'].value=="") {
		f['passwd'].focus();
		alert("비밀번호를 입력 하세요.");
		return;
	}
	// document.getElementById("loading").style.display = '';
	// setTimeout(function(){document.getElementById("loading").style.display = 'none';}, 3000);
	document.getElementById("loading").style.display = 'block';

	f.target = "login_ifrm";
	f.submit();
}
</script>

<script>
function fSign(sinput){
	setUniSign("comp");
	var ssn = document.getElementById("vendCd").value;
	if (ssn == null || ssn.length == 0) {
		alert("사업자번호를 입력해주세요.");
		return;
	}
	if (ssn.length != 10) {
		alert("사업자번호는 10자리로 입력하셔야 합니다.");
		return;
	}

    /* 서명데이타 만들기 */
    var f = document.forms['signFrm'];
    var	org_data = "nocedocu";	//	서명대상 원본데이타
    var	sign_data = "";
    
    unisign.SignDataNVerifyVID( org_data, null, ssn,
        function(rv, signedText, certAttrs)
        {
            sign_data = signedText;

            if ( null === sign_data || '' === sign_data || false === rv )
            {
                unisign.GetLastError(
                    function(errCode, errMsg)
                    {
                        if(errCode == "999"){
                            //사용자 취소
                        }else if(errCode == "14208"){
                            alert("선택한 인증서는 귀사의 인증서가 아닙니다.");
                        }else{
                            alert('Error code : ' + errCode + '\n\nError Msg : ' + errMsg);
                        }
                    }
                );
            } else {
                //console.log(JSON.stringify(certAttrs,null,2));
                //인증서 확인 단계
                var cert_end_date = getFormatDate(certAttrs.validateTo);
                if (cert_end_date.length < 8){
                    alert("유효하지 않은 인증서입니다.(유효일자 미확인)\n\n다시 한번 인증서를 확인 하십시오.");
                    return;
                }
                if (!isValidDate(cert_end_date))
                {
                    alert("유효하지 않은 인증서입니다.(유효일자 미확인)\n\n다시 한번 인증서를 확인 하십시오.");
                    return;
                }
                if (js_isDateCmp(cert_end_date, "{{_sysdate}}"))
                {
                    alert("유효기간이 지난 인증서 입니다.\n\n다시 한번 인증서를 확인 하십시오.");
                    return;
                }

                f['vend_cd'].value = ssn;
                f['sign_data'].value = sign_data;
                f['cert_dn'].value=certAttrs.subjectName;
                f['cert_end_date'].value=cert_end_date;
                
                f.target = "login_ifrm";
                f.submit();
            }
        }
    );
}

function fCrosscerUrl()
{
    window.open('https://raadmin.crosscert.com/customer/nongshim/index.html','_blank');
}

function fTradesignUrl()
{
    window.open('http://www.tradesign.net/ra/nongshimsc','_blank');
}

function closeLoading() {
	document.getElementById("loading").style.display = 'none';
}
</script>
<form name="signFrm" method="post" action="{{loginurl}}">
	<input type="hidden" name="sign_data" />
	<input type="hidden" name="vend_cd" />
	<input type="hidden" name="cert_dn" value="{{_auth._CERT_DN}}" />
	<input type="hidden" name="cert_end_date" value="{{_auth._CERT_END_DATE}}" />
</form>

<div id="loading"><img id="loading-image" src="../html/images/common/loading.gif" alt="Loading..."></div>