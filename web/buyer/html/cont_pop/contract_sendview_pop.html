 <!-- 전자인증 모듈 설정 //-->
<!-- INCLUDE FILE 'layout/crosscert_include.html' -->
<!-- 전자인증 모듈 설정 //-->

<div style="width: 1000px;">

<form novalidate name="form1" method="post" enctype="multipart/form-data" onsubmit="return formSubmit(this);">
<input type="hidden" name="cont_hash" value="{{cont.cont_hash}}"/>
<input type="hidden" name="sign_data"/>
<input type="hidden" name="sign_dn"/>
<input type="hidden" name="agree_seq" value="{{agree_seq}}"/>
<input type="hidden" name="direct_confirm"/>

<!-- IF START 'agreeTemplate' -->
<div class="div_table">
	<div class="util-row">
	    <div class="push-left">
	        <h3>계약진행정보</h3>
	    </div>
	</div>
	<div class="contract-info">
		<ul>
			<li class="is-active">
		       <em><span>작성자</span></em>             
		       <div class="info-body">
		       		<p class="info-name">{{cont.writer_name}}</p>
					<p class="info-message">완료</p>
					<span>{{cont.reg_date}}</span>        
		       </div>
			</li>
	        <!-- LOOP START 'agreeTemplate' -->
		        <li class="{{agreeTemplate.css}}">
					<em><span>{{agreeTemplate.agree_name}}</span></em>
					<div class="info-body">
						<p class="info-name">{{agreeTemplate.agree_person_name}}</p>
						<p class="info-message">{{agreeTemplate.agree_status_nm}}</p>
						<span>{{agreeTemplate.ag_md_date}}</span>    
			       </div>					
				</li>	
			<!-- LOOP END 'agreeTemplate' -->
		</ul>
	</div>
</div>
<!-- IF END 'agreeTemplate' -->

<!-- IF START 'isReject' -->
<div class="div_table">
	<div class="util-row">
	    <div class="push-left">
	        <h3>내부 반려</h3>
	    </div>
	</div>
	<table>
		<colgroup>
			<col width="20%">
			<col width="*">
		</colgroup>
		<tr>
		  <th>반려 사유</th>
		  <td>{{mod_reason}}</td>
		</tr>
	</table>
</div>
<!-- IF END 'isReject' -->

<!-- IF START 'cont.mod_req_date' -->
<div class="div_table">
	<div class="util-row">
	    <div class="push-left">
	        <h3>수정요청/반려 사유</h3>
	    </div>
	    <div class="push-right">
			계약상태: <span class="caution-text"><b>{{cont.status_name}}</b></span>
	    </div>
	</div>
	<table>
		<colgroup>
			<col width="20%">
			<col width="30%">
			<col width="20%">
			<col width="30%">
		</colgroup>
		<tr>
			<th>요청업체명</th>
			<td>{{cont.mod_req_name}}</td>
			<th>요청일시</th>
			<td>{{cont.mod_req_date}}</td>
		</tr>
		<tr>
			<th>사유</th>
			<td colspan="3">{{cont.mod_req_reason}}</td>
		</tr>
	</table>
</div>
<!-- IF END 'cont.mod_req_date' -->

<div class="div_table">
	<div class="util-row">
	    <div class="push-left">
	        <h3>계약기본정보</h3>
	    </div>
		<!-- IFNOT START 'cont.mod_req_date' -->
			<div class="push-right">
				계약상태: <span class="caution-text"><b>{{cont.status_name}}</b></span>
		    </div>
		<!-- IFNOT END 'cont.mod_req_date' -->
	</div>
	<table>
		<colgroup>
			<col width="10%">
			<col width="52%">
			<col width="8%">
			<col width="30%">
		</colgroup>
		<tr>
			<th>계약명</th>
			<td colspan="3">{{cont.cont_name}}</td>
		</tr>
		<tr>
			<th>계약일자</th>
			<td>{{cont.cont_date}}</td>
			<th>계약번호</th>
			<td>{{cont.cont_userno}}</td>
		</tr>
		<!-- IF START 'kakao' -->
		<tr>
			<th>수익쉐어</th>
			<td>{{cont.cont_etc1}}</td>
			<th>양도/종료</th>
			<td>{{cont.cont_etc2}}</td>
		</tr>
		<tr>
			<th>기타사항</th>
			<td colspan="3">{{cont.cont_etc3}}</td>
		</tr>
		<!-- IF END 'kakao' -->
		<!-- IF START 'change_cont' -->
		<tr>
			<th>계약구분</th>
			<td colspan="3">
				<font color="red"><b>{{cont.change_gubun_str}}</b></font>
			</td>
		</tr>
		<!-- IF END 'change_cont' -->
	</table>
</div>

<div>
	<div class="cont_tab">
		<span class="tab_on" id="tab_0" onClick="tabView(0)">{{template.template_name}}</span>&nbsp;

		<!-- LOOP START 'contSub' -->
			<!-- IFNOT START 'contSub.hidden' -->
				<span class="tab_off" style="margin-left:-5" id="tab_{{contSub.sub_seq}}" onClick="tabView({{contSub.sub_seq}})">{{contSub.cont_sub_name}}<!-- IFC START 'contSub.gubun==50' --> <button type="button" class="sbtn ico-save" rewrite="Y" onClick="innerSave('{{contSub.cont_no}}','{{contSub.cont_chasu}}',{{contSub.sub_seq}})"><span></span>저장</button><!-- IFC END 'contSub.gubun==50' --></span>
			<!-- IFNOT END 'contSub.hidden' -->
			<!-- IF START 'contSub.hidden' -->
				<span class="tab_off" id="tab_{{contSub.sub_seq}}" style="display:none" onClick="tabView({{contSub.sub_seq}})">{{contSub.cont_sub_name}}</span>
			<!-- IF END 'contSub.hidden' -->
			<input type="hidden" name="cont_sub_name" value="{{contSub.cont_sub_name}}"><input type="hidden" name="cont_sub_style" value="{{contSub.cont_sub_style}}">
		<!-- LOOP END 'contSub' -->
	</div>
	<div class="cont_warp">
		<div id="__html">
			<div style="{{template.template_style}}; padding-top: 10px" id="__html_0">
			{{cont.cont_html}}
			</div>

			<!-- LOOP START 'contSub' -->
			<div style="{{contSub.cont_sub_style}}; padding-top: 10px; display:none" id="__html_{{contSub.sub_seq}}">
				{{contSub.cont_sub_html}}
			</div>
			<!-- LOOP END 'contSub' -->
		</div>
	</div>
</div>	
	
<!-- LOOP START 'sign_template' -->
<input type="hidden" name="sign_seq" value="{{sign_template.sign_seq}}"/>
<input type="hidden" name="signer_name" value="{{sign_template.signer_name}}"/>
<input type="hidden" name="signer_max" value="{{sign_template.signer_max}}"/>
<input type="hidden" name="member_type" value="{{sign_template.member_type}}"/>
<div class="div_table">
	<div class="util-row">
	    <div class="push-left">
	        <h3>{{sign_template.signer_name}}</h3>
	    </div>
	</div>
	<table id="comp_grid_{{sign_template.sign_seq}}" style="border: 1px;">
		<thead>
			<tr style="display: none;"><td style="height: 0px;"></td></tr>
		</thead>
		<tbody>
		</tbody>
	</table>
</div>
<!-- LOOP END 'sign_template' -->

<!-- IF START 'cust_chain' -->
<div class="div_table">
	<div class="util-row">
	    <div class="push-left">
	        <h3>연대보증</h3>
	    </div>
	</div>
	<table>
		<colgroup>
			<col width="70%">
			<col width="30%">
		</colgroup>
		<!-- LOOP START 'cust_chain' -->
			<tr>
				<td>
					<!-- IF START 'cust_chain.member_name' -->
					{{cust_chain.member_name}}
					<!-- IF END 'cust_chain.member_name' -->
					({{cust_chain.user_name}})
					<!-- IF START 'cust_chain.tel_num' -->
					/ {{cust_chain.tel_num}}
					<!-- IF END 'cust_chain.tel_num' -->
					<!-- IF START 'cust_chain.hp1' -->
					/ {{cust_chain.hp1}}-{{cust_chain.hp2}}-{{cust_chain.hp3}}
					<!-- IF END 'cust_chain.hp1' -->
					/ {{cust_chain.email}} <button type="button" class="sbtn ico-change" nClick="OpenWindow('/web/buyer/contract/pop_email.jsp?cont_no={{cont.cont_no}}&cont_chasu={{cont.cont_chasu}}&cust_member_no={{cust_chain.member_no}}', 'email', 600, 160);"><span></span>계약메일 재전송</button>
				</td>
				<!-- IF START 'cust_chain.sign_dn' -->
					<td align="right">서명일시: <b style="color:blue">{{cust_chain.sign_date}}</b></td>
				<!-- IF END 'cust_chain.sign_dn' -->
				<!-- IFNOT START 'cust_chain.sign_dn' -->
					<td align="right">서명일시: <b style="color:red">미서명</b></td>
				<!-- IFNOT END 'cust_chain.sign_dn' -->
			</tr>
		<!-- LOOP END 'cust_chain' -->
	</table>
</div>
<!-- IF END 'cust_chain' -->

<div class="div_table">
	<div class="util-row">
	    <div class="push-left">
	    	<h3>계약서류</h3>
	    </div>
	</div>
	<table id="cfile_grid">
		<colgroup>
			<col width="15%"/>
			<col width="45%"/>
			<col width="40%"/>
		</colgroup>
		<thead>
			<tr>
				<th>파일구분</th>
				<th>계약서류명</th>
				<th>첨부</th>
			</tr>
		</thead>
		<tbody>
			<!-- LOOP START 'cfile' -->
				<tr>
					<td align="center"><span class="{{cfile.auto_class}}">{{cfile.auto_str}}</span></td>
					<td><input type="text" name="cfile_doc_name" value="{{cfile.doc_name}}" class="in_readonly" readonly style="width:98%" /></td>
					<td align="right">
						<!-- IF START 'cfile.file_name' -->
					 	{{cfile.file_size_str}}&nbsp;&nbsp;
					 	<button type="button" class="sbtn ico-print" value="{{cfile.btn_name}}" onclick="{{cfile.down_script}}"><span></span>조회(인쇄)</button>
						<!-- IF END 'cfile.file_name' -->
						<input type="hidden" name="cfile_seq" value="{{cfile.cfile_seq}}"/>
						<input type="hidden" name="cfile_auto_type" value="{{cfile.auto_type}}"/>
					</td>
				</tr>
			<!-- LOOP END 'cfile' -->
		</tbody>
	</table>
</div>

<!-- IF START 'stamp' -->
<div class="div_table">
	<div class="util-row">
	    <div class="push-left">
	        <h3>인지세</h3>
		</div>
	</div>
	<table>
		<colgroup>
		    <col width="23%">
		    <col width="12%">
		    <col width="15%">
		    <col width="10%">
		    <col width="10%">
		    <col width="20%">
		    <col width="10%">
		</colgroup>
		<thead>
			<tr>
			  	<th>납부업체</th>
			    <th>사업자번호</th>
			    <th>인지세 고유번호</th>
			    <th>인지세액</th>
			    <th>발급일자</th>
			    <th>발급처</th>
			    <th>등록/조회</th>
			</tr>
		</thead>
		<tbody>
		<!-- LOOP START 'stamp' -->
			<!-- IFNOT START 'stamp.cert_no' -->
				<tr>
					<td align="center">{{stamp.member_name}}</td>
					<td align="center">{{stamp.vendcd}}</td>
					<td colspan="4"></td>
					<td align="center">
						<button type="button" class="sbtn ico-save" onclick="fPopupStampInfo('{{stamp.cont_no}}','{{stamp.cont_chasu}}','{{stamp.member_no}}');"><span></span>등록</button>
					</td>
				</tr>
			<!-- IFNOT END 'stamp.cert_no' -->
	    	<!-- IF START 'stamp.cert_no' -->
				<tr>
					<td align="center">{{stamp.member_name}}</td>
					<td align="center">{{stamp.vendcd}}</td>
					<td align="center">{{stamp.cert_no}}</td>
					<td align="center">￦{{stamp.stamp_money}}</td>
					<td align="center">{{stamp.issue_date}}</td>
					<td align="center">{{stamp.channel}}</td>
					<td align="center">
						<button type="button" class="sbtn ico-search" onclick="fPopupStampInfo('{{stamp.cont_no}}','{{stamp.cont_chasu}}','{{stamp.member_no}}');"><span></span>조회</button>
					</td>
				</tr>
			<!-- IF END 'stamp.cert_no' -->
		<!-- LOOP END 'stamp' -->
		</tbody>
	</table>
</div>
<!-- IF END 'stamp' -->

<!-- IF START 'warr' -->
<div class="div_table">
	<div class="util-row">
	    <div class="push-left">
	        <h3>보증서류</h3>
		</div>
	</div>
	<table>
		<colgroup>
			<col width="10%">
			<col width="15%">
			<col width="14%">
			<col width="10%">
			<col width="18%">
			<col width="14%">
			<col width="10%">
		</colgroup>
		<thead>
			<tr>
				<th>보증서종류</th>
				<th>발급기관</th>
				<th>증권번호</th>
				<th>발급일자</th>
				<th>보증기간</th>
				<th>보증금액</th>
				<th>등록/조회</th>
			</tr>
		</thead>
		<tbody>
		<!-- LOOP START 'warr' -->
			<!-- IFNOT START 'warr.warr_no' -->
				<tr>
					<td align="center">{{warr.warr_type}}</td>
					<td colspan="5"><b>비고:</b> {{warr.etc}} &nbsp;<!-- IF START 'warr.haja' -->[계약완료후 등록]<!-- IF END 'warr.haja' --></td>
					<td align="center">
					<!-- IFNOT START 'warr.haja' -->
						<!-- IF START 'gap_yn' -->
							미등록
						<!-- IF END 'gap_yn' -->
						<!-- IFNOT START 'gap_yn' -->
							<button type="button" class="sbtn ico-save" onclick="contWarr('{{warr.cont_no}}','{{warr.cont_chasu}}','{{warr.warr_seq}}' )"><span></span>등록</button>
						<!-- IFNOT END 'gap_yn' -->
					<!-- IFNOT END 'warr.haja' -->
					</td>
				</tr>
			<!-- IFNOT END 'warr.warr_no' -->
	   		<!-- IF START 'warr.warr_no' -->
				<tr>
					<td align="center">{{warr.warr_type}}</td>
					<td align="center">{{warr.warr_office}}</td>
					<td align="center">{{warr.warr_no}}</td>
					<td align="center">{{warr.warr_date}}</td>
					<td align="center">{{warr.warr_sdate}} ~ {{warr.warr_edate}}</td>
					<td align="right">￦{{warr.warr_amt}}</td>
					<td align="center">
						<button type="button" class="sbtn ico-search" onclick="contWarr('{{warr.cont_no}}','{{warr.cont_chasu}}','{{warr.warr_seq}}' )"><span></span>조회</button>
					</td>
				</tr>
			<!-- IF END 'warr.warr_no' -->
		<!-- LOOP END 'warr' -->
		</tbody>
	</table>
</div>
<!-- IF END 'warr' -->

</form>
{{form_script}}

<!-- LOOP START 'rfile_cust' -->
<form name="form_{{rfile_cust.member_no}}" method="post" enctype="multipart/form-data" action="/web/buyer/contract/contract_rfile_insert.jsp?{{query}}" onsubmit="return formSubmit2(this)">
<input type="hidden" name="rfile_path" value="{{file_path}}"/>
<input type="hidden" name="rfile_member_no" value="{{rfile_cust.member_no}}">
<input type="hidden" name="from_page" value="/web/buyer/cont_pop/contract_send_view_pop.jsp"/>
<!-- IF START 'rfile' -->
<div class="div_table">
	<div class="util-row">
	    <div class="push-left">
	        <h3>구비서류({{rfile_cust.member_name}}) <span class=caution-text>※구비서류는 계약서 서명하기 전까지 계약상대방에게 요청하여 변경 및 첨부 가능.</span></h3>
		</div>
	    <div class="push-right">
	    	<button type="submit" class="sbtn ico-save" ><span></span>구비서류 저장</button>
		</div>
	</div>
	<table id="rfile_grid">
		<colgroup>
			<col width="8%"/>
			<col width="67%"/>
			<col width="25%"/>
		</colgroup>
		<thead>
			<tr>
				<th>필수여부</th>
				<th>문서명</th>
				<th>첨부파일</th>
			</tr>
		</thead>
		<tbody>
			<!-- LOOP START 'rfile' -->
				<tr>
					<td align="center">
						<input type="checkbox" name="attch" {{rfile.attch}} disabled>
						<input type="hidden" name="attch_yn" value="{{rfile.attch_yn}}">
					</td>
					<td>{{rfile.doc_name}}</td>
					<td align="center" id="rfile_area_{{rfile_cust.member_no}}_{{rfile.rfile_seq}}">
						<!-- IFNOT START 'rfile.file_name' -->
							<span id="rfile_{{rfile_cust.member_no}}_{{rfile.rfile_seq}}_1">
								미첨부&nbsp;&nbsp;&nbsp;&nbsp;<button type="button" class="sbtn ico-save" onclick="showFileAtt('{{rfile_cust.member_no}}','{{rfile.rfile_seq}}')"><span></span>직접첨부</button>
							</span>
							<span style="display:none" id="rfile_{{rfile_cust.member_no}}_{{rfile.rfile_seq}}_2">
								<input type="hidden" name="rfile_seq" value="{{rfile.rfile_seq}}"/>
								<input type="file" name="rfile_{{rfile.rfile_seq}}" style="width:95%"/>
							</span>
							
							<!-- IF START 'rfile.allow_ext' -->
								<br><span class="caution-text"> ※ {{rfile.allow_ext}} 파일만 첨부 가능</span>
							<!-- IF END 'rfile.allow_ext' -->
						<!-- IFNOT END 'rfile.file_name' -->
						
						<!-- IF START 'rfile.file_name' -->
							<font color="#0000ff">등록완료</font>(파일크기:{{rfile.file_size}})<br>
							<button type="button" class="sbtn ico-save" onclick="filedown('file.path.bcont_pdf','{{rfile.file_path}}{{rfile.file_name}}','{{rfile.doc_name}}.{{rfile.file_ext}}')"><span></span>다운로드</button>
							<button type="button" class="sbtn ico-delete" onclick="delFile('{{rfile_cust.member_no}}','{{rfile.rfile_seq}}')"><span></span>삭제</button>
						<!-- IF END 'rfile.file_name' -->
					</td>
				</tr>
			<!-- LOOP END 'rfile' -->
		</tbody>
	</table>
</div>				
<!-- IF END 'rfile' -->
</form>
<!-- LOOP END 'rfile_cust' -->

<!-- IF START 'cont.efile_yn' -->
<form name="form_efile" method="post" enctype="multipart/form-data" action="/web/buyer/contract/contract_efile_insert.jsp?{{query}}" onsubmit="return formSubmit3(this)">
<input type="hidden" name="efile_path" value="{{file_path}}"/>
<input type="hidden" name="from_page" value="/web/buyer/cont_pop/contract_send_view_pop.jsp"/>
<div class="div_table">
	<div class="util-row">
	    <div class="push-left">
	        <h3>내부관리서류 <span class="caution-text">※ 계약과 관련된 내부관리서류 첨부, 내부에서만 조회 가능.</span></h3>
		</div>
	    <div class="push-right">
		  	<button type="button" class="sbtn ico-add" onclick="addEfileRow();"><span></span>추가</button>
		  	<button type="submit" class="sbtn ico-save" ><span></span>관리서류 저장</button>
		</div>
	</div>
	<table id="efile_grid">
		<colgroup>
			<col width="15%"/>
			<col width="40%"/>
			<col width="35%"/>
			<col width="10%"/>
		</colgroup>
		<thead>
			<tr>
				<th>관리유형</th>
				<th>문서명</th>
				<th>첨부파일</th>
				<th>삭제</th>
			</tr>
		</thead>
		<tbody>
			<!-- LOOP START 'efile' -->
				<tr>
					<td align="center">{{efile.str_reg_type}}<input type="hidden" name="efile_reg_type" value="{{efile.reg_type}}"/></td>
					<td><input type="text" name="efile_doc_name" value="{{efile.doc_name}}" class="{{efile.doc_name_class}}" {{efile.doc_name_readonly}} style="width:98%" hname="계약서류명" {{efile.required}} /></td>
					<td align="center">
						<!-- IF START 'efile.file_name' -->
							<span id="div_efile_{{efile.efile_seq}}">
								<!-- <input type="file" name="efile_{{efile.efile_seq}}" style="width:200px" hname="관리서류 파일"/> -->
							 	<font color="#0000ff">등록완료</font>(파일크기:{{efile.file_size_str}})&nbsp;
							 	<button type="button" class="sbtn ico-download" onclick="{{efile.down_script}}"><span></span>다운로드</button>
						 	</span>
						<!-- IF END 'efile.file_name' -->
						
						<!-- IFNOT START 'efile.file_name' -->
						<input type="file" name="efile_{{efile.efile_seq}}" style="width:98%" hname="관리서류 파일" {{efile.required}} />
						<!-- IFNOT END 'efile.file_name' -->
						<input type="hidden" name="efile_seq" value="{{efile.efile_seq}}"/>
						<input type="hidden" name="efile_del_yn" id="efile_del_yn_{{efile.efile_seq}}">
					</td>
					<td>
						<!-- IF START 'efile.del_yn10' -->
							<button type="button" class="sbtn ico-delete" onclick="delEfile('{{efile.efile_seq}}','10');this.style.display='none';"><span></span>삭제</button>
						<!-- IF END 'efile.del_yn10' -->
						
						<!-- IF START 'efile.del_yn20' -->
							<button type="button" class="sbtn ico-delete" onclick="delEfile('{{efile.efile_seq}}','20');this.style.display='none';"><span></span>삭제</button>
						<!-- IF END 'efile.del_yn20' -->
						
						<!-- IF START 'efile.del_yn30' -->
							<button type="button" class="sbtn ico-delete" onclick="efile_grid.del(this);"><span></span>삭제</button>
						<!-- IF END 'efile.del_yn30' -->
					</td>
				</tr>
			<!-- LOOP END 'efile' -->
		</tbody>
	</table>
</div>
</form>
<!-- IF END 'cont.efile_yn' -->

<div class="btn-group-wrap">
	<!-- IF START 'agreeTemplate' -->

		<!-- IF START 'sign_able' -->
		<button type="button" class="btn color ico-request" onclick="if(formSubmit(document.forms['form1'])){document.forms['form1'].submit();}"><span></span>계약서 서명</button>
		
			<!-- IF START 'towriter_reject_able' -->
				<button type="button" class="btn color ico-change" onclick="rejectReq({{agree_seq}})"><span></span>반려(작성자)</button>
			<!-- IF END 'towriter_reject_able' -->

			<!-- IF START 'tocust_reject_able' -->
				<button type="button" class="btn color ico-change" onclick="modifyReq({{agree_seq}})"><span></span>반려(업체)</button>
			<!-- IF END 'tocust_reject_able' -->
		
		<!-- IF END 'sign_able' -->

		<!-- IF START 'direct_able' -->
		<button type="button" class="btn color ico-caution" onclick="if(confirm('계약서를 완료 처리 하시겠습니까?')){location.href='direct_confirm_pop.jsp?{{query}}&agree_seq={{agree_seq}}';}"><span></span>계약서 완료</button>

			<!-- IF START 'towriter_reject_able' -->
				<button type="button" class="btn color ico-change" onclick="rejectReq({{agree_seq}})"><span></span>반려(작성자)</button>
			<!-- IF END 'towriter_reject_able' -->
	
			<!-- IF START 'tocust_reject_able' -->
				<button type="button" class="btn color ico-change" onclick="modifyReq({{agree_seq}})"><span></span>반려(업체)</button>
			<!-- IF END 'tocust_reject_able' -->
		
		<!-- IF END 'direct_able' -->			
		
		<!-- IF START 'send_cancel' -->
			<button type="button" class="btn color ico-cancel" onclick="if(confirm('전송취소 하시겠습니까?')){location.href='contract_send_cancel_pop.jsp?{{query}}';}"><span></span>전송취소</button>
		<!-- IF END 'send_cancel' -->
		
		<!-- IF START 'send_able' -->
			<button type="button" class="btn color ico-request" onclick="if(confirm('계약 서명요청 하시겠습니까?\n\n수정한 내용이 있을 경우 저장 후 서명요청 하세요.')){location.href='contract_send_pop.jsp?{{query}}&agree_seq={{agree_seq}}'}"><span></span>서명요청</button>
			<button type="button" class="btn color ico-change" onclick="rejectReq({{agree_seq}})"><span></span>반려(작성자)</button>
		<!-- IF END 'send_able' -->
		
		<!-- IF START 'modify_able' -->
			<button type="button" class="btn color ico-write" onclick="if(confirm('계약서를 수정하시겠습니까?\n\n계약서를 수정하기 위해 작성중 메뉴로 이동합니다.')){location.href='contract_send_cancel_pop.jsp?{{query}}';}"><span></span>계약수정</button>
		<!-- IF END 'modify_able' -->
		
		<!-- IF START 'return_able' -->
			<button type="button" class="btn color ico-write" onclick="if(confirm('계약서를 수정하시겠습니까?\n\n계약서를 수정하기 위해 작성중 메뉴로 이동합니다.')){location.href='contract_send_cancel_pop.jsp?{{query}}';}"><span></span>계약수정</button>
		<!-- IF END 'return_able' -->
		
		<!-- IF START 'agree_able' -->
			<button type="button" class="btn color ico-confirm" onclick="if(confirm('계약서를 승인 하시겠습니까?')){location.href='contract_confirm_pop.jsp?{{query}}&agree_seq={{agree_seq}}';}"><span></span>계약서 승인</button>
				
				<!-- IF START 'towriter_reject_able' -->
					<button type="button" class="btn color ico-change" onclick="rejectReq({{agree_seq}})"><span></span>반려(작성자)</button>
				<!-- IF END 'towriter_reject_able' -->
			
				<!-- IF START 'tocust_reject_able' -->
					<button type="button" class="btn color ico-change" onclick="modifyReq({{agree_seq}})"><span></span>반려(업체)</button>
				<!-- IF END 'tocust_reject_able' -->
		
		<!-- IF END 'agree_able' -->
		
		<!-- IF START 'agree_cancel' -->
			<button type="button" class="btn color ico-cancel" onclick="if(confirm('계약서 승인을 취소 하시겠습니까?')){location.href='contract_agree_cancel_pop.jsp?{{query}}&agree_seq={{agree_seq}}';}"><span></span>승인 취소</button>
		<!-- IF END 'agree_cancel' -->
	
	<!-- IF END 'agreeTemplate' -->
	
	<!-- IFNOT START 'agreeTemplate' -->
		
		<!-- IF START 'sign_able' -->
			<button type="button" class="btn color ico-confirm" onclick="if(formSubmit(document.forms['form1'])){document.forms['form1'].submit();}"><span></span>계약서 서명</button>
		<!-- IF END 'sign_able' -->

		<!-- IF START 'send_cancel' -->
			<button type="button" class="btn color ico-cancel" onclick="if(confirm('전송취소 하시겠습니까?')){location.href='contract_send_cancel_pop.jsp?{{query}}';}"><span></span>전송 취소</button>
		<!-- IF END 'send_cancel' -->
		
		<!-- IF START 'return_able' -->
			<button type="button" class="btn color ico-change" onclick="modifyReq('')"><span></span>반려</button>
			<button type="button" class="btn color ico-write" onclick="if(confirm('계약서를 수정하시겠습니까?\n\n계약서를 수정하기 위해 작성중 메뉴로 이동합니다.')){location.href='contract_send_cancel_pop.jsp?{{query}}';}"><span></span>계약 수정</button>
		<!-- IF END 'return_able' -->
		
	<!-- IFNOT END 'agreeTemplate' -->
</div>

<form name="comp_form" method="post">
<table id="comp_template" style="display: none">
	<tr>
		<td>
			<table>
				<tr>
				  <td align="right">
				  	[[sign_date]]
				  </td>
				</tr>
			</table>
			<input type="hidden" name="member_no"/>
			<input type="hidden" name="vendcd"/>
			<input type="hidden" name="post_code"/>
			<input type="hidden" name="member_slno"/>
			<input type="hidden" name="cust_sign_seq"/>
			<input type="hidden" name="jumin_no"/>
			<input type="hidden" name="cust_gubun" value="01"/>
			<table style="border: 0px;">
				<colgroup>
					<col width="10%"/>
					<col width="23%"/>
					<col width="10%"/>
					<col width="23%"/>
					<col width="10%"/>
					<col width="24%"/>
				</colgroup>
				<tr>
					<th>주소</th>
					<td colspan="3"><input type="text" name="address" class="in_readonly" style="width:98%" readonly/></td>
					<th>담당자</th>
					<td><input type="text" name="user_name" class="in_readonly" style="width:98%" readonly/></td>
				</tr>
				<tr>
					<th>상호</th>
					<td colspan="3"><input type="text" name="member_name" style="width:98%" class="in_readonly" readonly/></td>
					<th>이메일</th>
					<td><input type="text" name="email" class="in_readonly" style="width:98%" readonly/></td>
				</tr>
				<tr>
					<th>대표자</th>
					<td><input type="text" name="boss_name" class="in_readonly" style="width:98%" readonly/></td>
					<th>일반전화</th>
					<td><input type="text" name="tel_num" class="in_readonly" style="width:98%" readonly/></td>
					<th>휴대폰</th>
					<td>
						<input type="text" name="hp1" class="in_readonly" maxlength="3" style="width:28%" readonly/>-
						<input type="text" name="hp2" class="in_readonly" maxlength="4" style="width:30%" readonly/>-
						<input type="text" name="hp3" class="in_readonly" maxlength="4" style="width:30%" readonly/>
					</td>
				</tr>
			</table>
		</td>
	</tr>
</table>
</form>

<form name="person_form" method="post">
<table id="person_template" style="display: none">
	<tr>
		<td>
			<input type="hidden" name="member_no"/>
			<input type="hidden" name="vendcd"/>
			<input type="hidden" name="post_code"/>
			<input type="hidden" name="member_slno"/>
			<input type="hidden" name="cust_sign_seq"/>
			<input type="hidden" name="user_name"/>
			<input type="hidden" name="boss_name"/>
			<input type="hidden" name="jumin_no"/>
			<input type="hidden" name="cust_gubun" value="02"/>
			<table>
				<tr align="right">
					<td>
					서명일시: [[sign_date]]
					</td>
				</tr>
			</table>
			<table style="border: 0px;">
				<colgroup>
					<col width="10%"/>
					<col width="57%"/>
					<col width="10%"/>
					<col width="23%"/>
				</colgroup>
				<tr>
					<th>이름</th>
					<td colspan="3"><input type="text" name="member_name" class="in_readonly" readonly style="width:98%" maxlength="100" hname="상호" required="Y" onblur="setCustArea()"/></td>
				</tr>
				<tr>
					<th>주소</th>
					<td><input type="text" name="address" class="in_readonly" readonly style="width:98%" maxlength="100" hname="주소" required="Y" onblur="setCustArea()"/></td>
					<th>이메일</th>
					<td><input type="text" name="email" class="in_readonly" readonly style="width:98%" maxlength="150" hname="이메일" option="email" required="Y"/></td>
				</tr>
				<tr>
					<th>일반전화</th>
					<td><input type="text" name="tel_num" class="in_readonly" readonly style="width:98%" maxlength="20"/></td>
					<th>휴대폰</th>
					<td>
						<input type="text" name="hp1" class="in_readonly" readonly maxlength="3" style="width:28%" hname="휴대폰" required="Y"/>-
						<input type="text" name="hp2" class="in_readonly" readonly maxlength="4" style="width:30%" hname="휴대폰" required="Y"/>-
						<input type="text" name="hp3" class="in_readonly" readonly maxlength="4" style="width:30%" hname="휴대폰" required="Y"/>
					</td>
				</tr>
			</table>
		</td>
	</tr>
</table>
</form>

<table id="efile_template" style="display:none">
	<tr>
		<td align="center">추가첨부<input type="hidden" name="efile_reg_type" value="30"/></td>
		<td><input type="text" name="efile_doc_name" style="width:98%" hname="문서명" required="Y" /></td>
		<td>
			<input type="hidden" name="efile_del_yn">
			<input type="file" name="efile_[[seq]]" style="width:80%" hname="문서 파일" required="Y" />
			<input type="hidden" name="efile_seq" value="[[seq]]"/>
		</td>
		<td><button type="button" class="sbtn ico-delete" onclick="efile_grid.del(this);"><span></span>삭제</button></td>
	</tr>
</table>

<iframe name="fra_pay" id="fra_pay" style="display:none"></iframe>

<script language="javascript">

if( window.attachEvent )  // IE의 경우
	window.attachEvent( "onload", convertHtml );
else  // IE가 아닌 경우.
	window.addEventListener( "load", convertHtml , false );
	
function convertHtml(){
	var status = "{{cont.status}}";
	if(status == "1") return;

	removeInput2(document.getElementById("__html_0"));
	<!-- LOOP START 'contSub' -->
	<!-- IFC START 'contSub.gubun!=50' -->
	removeInput2(document.getElementById("__html_{{contSub.sub_seq}}"));
	<!-- IFC END 'contSub.gubun!=50' -->
	<!-- LOOP END 'contSub' -->
}

function formSubmit(f){
	if(validate(f)){
		if(!confirm("서명 하시겠습니까?")){
			return false;
		}
		<!-- IF START 'serverSign' -->
		f.submit();
		<!-- IF END 'serverSign' -->
		<!-- IFNOT START 'serverSign' -->
		fSign();
		<!-- IFNOT END 'serverSign' -->
	}
	return false;
}

function formSubmit2(f){
	if(validate(f)){
		if(confirm("저장 하시겠습니까?")){
			return true;
		}
	}
	return false;
}


//인증서 선택창 띄우고 계약서서명 실행
function fSign() {
	var f = document.forms["form1"];

	<!-- IF START 'serverSign' -->
    f.submit();
    return;
    <!-- IF END 'serverSign' -->
	
	
	var cert_dn ="{{_auth._CERT_DN}}";
	if(cert_dn == ""){
		alert("전자계약시 사용할 법인인증서가 등록되어 있지 않습니다.\n\n화면상단 우측의 회원정보수정을 클릭하여 표시되는 회원메뉴>회사정보변경 화면에서\n\n법인인증서를 등록한 후 계약서에 전자서명 하시기 바랍니다.\n\n※ 회사정보변경 메뉴는 관리자만 접근가능 하며, 법인인증서 등록후 다시 로그인을 해야 적용 됩니다.");
		return false;
	}
	var vendcd = "{{_auth._VENDCD}}";


	var cont_hash = f['cont_hash'].value;    // 계약서류 hash에 서명한 값
	if(cont_hash==""){
		alert("서명대상 데이터가 존재 하지 않습니다. 고객센터(02-788-9097)로 문의해 주세요.");
		return false;
	}

	setUniSign("comp");
	unisign.SignDataNVerifyVID( cont_hash, null, vendcd, 
		function(rv, signedText, certAttrs)
		{ 
			sSignData = signedText;
			
			if ( null === sSignData || '' === sSignData || false === rv )
			{
				unisign.GetLastError(
					function(errCode, errMsg) 
					{ 
						if(errCode == "999"){
							//사용자 취소
						}else if(errCode == "14208"){
							alert("선택한 인증서는 귀사의 인증서가 아닙니다.");
						}else{
							alert('Error code : ' + errCode + '\n\nError Msg : ' + errMsg);
						}
					}
				);
			} else {
				//console.log(JSON.stringify(certAttrs,null,2));
				//인증서 확인 단계
				var signEnddt = getFormatDate(certAttrs.validateTo);
				if (signEnddt.length < 8){
					alert("유효하지 않은 인증서입니다.(유효일자 미확인)\n\n다시 한번 인증서를 확인 하십시오.");
					return;
				}
				if (!isValidDate(signEnddt))
				{
					alert("유효하지 않은 인증서입니다.(유효일자 미확인)\n\n다시 한번 인증서를 확인 하십시오.");
					return;
				}
				if (js_isDateCmp(signEnddt, "{{_sysdate}}"))
				{
					alert("유효기간이 지난 인증서 입니다.\n\n다시 한번 인증서를 확인 하십시오.");
					return;
				}
				if (certAttrs.subjectName != cert_dn)
				{
					alert("선택한 인증서와 등록된 인증서가 일치하지 않습니다.");
					return;
				}
				f['sign_dn'].value = certAttrs.subjectName;
				f['sign_data'].value = sSignData;
				f.action = "";
				f.submit();
			}
		} 
	);
}



/*
 * 내부 문서용 : 완료 되기 전에 수정 저장
 */
function innerSave(no, chasu, seq)
{
	if(!confirm("저장 하시겠습니까?")){
		return;
	}

	var f = document.createElement("form");
	f.method = "post";
	f.encoding= "multipart/form-data";
	f.action = "/web/buyer/contract/inner_pdf.jsp"
	f.target = "fra_pay";

	var cont_no=document.createElement("input");
	cont_no.setAttribute("type", "hidden");
	cont_no.setAttribute("name", "cont_no");
	cont_no.value = no;

	var cont_chasu=document.createElement("input");
	cont_chasu.setAttribute("type", "hidden");
	cont_chasu.setAttribute("name", "cont_chasu");
	cont_chasu.value = chasu;

	var file_seq=document.createElement("input");
	file_seq.setAttribute("type", "hidden");
	file_seq.setAttribute("name", "seq");
	file_seq.value = seq;

	f.appendChild(cont_no);
	f.appendChild(cont_chasu);
	f.appendChild(file_seq);
	
	setDivInputValue("__html");
	splitHtml(f, 'cont_html', false, seq);
	splitHtml(f, 'cont_html_rm', true, seq);

	document.body.appendChild(f);
	f.submit();
}

function modifyReq(seq){
    OpenWindow("pop_modify_req_pop.jsp?cont_no={{cont.cont_no}}&cont_chasu={{cont.cont_chasu}}&agree_seq="+seq,"moidfy_req",600,500);
	return;
}

function rejectReq(seq){
    OpenWindow("pop_reject_req_pop.jsp?cont_no={{cont.cont_no}}&cont_chasu={{cont.cont_chasu}}&agree_seq="+seq,"moidfy_req",400,300);
	return;
}

function delFile(member_no,seq){
	var area = document.getElementById("rfile_area_"+member_no+"_"+seq);
	var html = '<input type="file" name="rfile_'+seq+'"  hname="첨부파일" style="width:95%"/>';
	    html += '<input type="hidden" name="rfile_seq" value="'+seq+'"/>';
	area.innerHTML = html;
}

function showFileAtt(member_no, rfile_seq){
	document.getElementById("rfile_"+member_no+"_"+rfile_seq+"_1").style.display = "none";
	document.getElementById("rfile_"+member_no+"_"+rfile_seq+"_2").style.display = "";
}


</script>

<script language="javascript">

<!-- IF START 'cont.efile_yn' -->

function formSubmit3(f){
	if(validate(f)){
		if(confirm('관리서류를 저장하시겠습니까?')){
			return true;
		}
	}
	return false;
}


var efile_grid = new MGRID("efile_grid");
efile_grid.cells = table2array("efile_template");

function addEfileRow(){
	var data = table2array("efile_template", new Array("seq=>"+(document.getElementById('efile_grid').rows.length)));
	efile_grid.addRow(null, data);
}
function delEfile(efile_seq, reg_type){
	var td = document.getElementById("div_efile_"+efile_seq);
	if(reg_type == "10"){
		td.innerHTML = '<input type="file" name="efile_'+efile_seq+'" style="width:98%" hname="관리서류 파일" required="Y" />'
	}
	if(reg_type == '20' ){
		td.innerHTML = '<input type="file" name="efile_'+efile_seq+'" style="width:98%" hname="관리서류 파일"  />'
		document.getElementById("efile_del_yn_"+efile_seq).value="Y";
	}
}
<!-- IF END 'cont.efile_yn' -->


<!-- LOOP START 'sign_template' -->
var comp_grid_{{sign_template.sign_seq}} = new MGRID("comp_grid_{{sign_template.sign_seq}}");
comp_grid_{{sign_template.sign_seq}}.cells = table2array("comp_template");
comp_grid_{{sign_template.sign_seq}}.cellClassName = "comp_grid_cell";
<!-- LOOP END 'sign_template' -->


var form_name = "comp_form";
var template_name= "comp_template";
</script>

<!-- LOOP START 'cust' -->
<script language="javascript">

if("02"=="{{cust.cust_gubun}}"){
	form_name = "person_form";
	template_name = "person_template";
}else{
	form_name = "comp_form";
	template_name = "comp_template";
}

SetFormValue(form_name,"member_no","{{cust.member_no}}");
SetFormValue(form_name,"vendcd","{{cust.vendcd}}");
SetFormValue(form_name,"post_code","{{cust.post_code}}");
SetFormValue(form_name,"member_slno","{{cust.member_slno}}");
SetFormValue(form_name,"cust_sign_seq","{{cust.sign_seq}}");
SetFormValue(form_name,"address","{{cust.address}}");
SetFormValue(form_name,"user_name","{{cust.user_name}}");
SetFormValue(form_name,"member_name","{{cust.member_name}}");
SetFormValue(form_name,"email","{{cust.email}}");
SetFormValue(form_name,"boss_name","{{cust.boss_name}}");
SetFormValue(form_name,"tel_num","{{cust.tel_num}}");
SetFormValue(form_name,"hp1","{{cust.hp1}}");
SetFormValue(form_name,"hp2","{{cust.hp2}}");
SetFormValue(form_name,"hp3","{{cust.hp3}}");
SetFormValue(form_name,"jumin_no","{{cust.jumin_no}}");

comp_grid_{{cust.sign_seq}}.cells = table2array(template_name, new Array("sign_date=>{{cust.sign_str}}"));

comp_grid_{{cust.sign_seq}}.addRow();
</script>
<!-- LOOP END 'cust' -->

</div>