<form name="form1" method="post">
    <input type="hidden" name="check_contract_info_yn">

    <input type="hidden" name="sign_dn">
    <input type="hidden" name="sign_data">
    <input type="hidden" name="cont_no" value="{{cont.cont_no}}">
    <input type="hidden" name="cont_chasu" value="{{cont.cont_chasu}}">
    <input type="hidden" name="email_random" value="{{cust.email_random}}">
    <!-- 계약업체 정보 조회 -->
    <div class="container-wrap">
        <div class="pc-title-block pc_pad">ㅣ
            <div class="inner-container">
                <div class="title-line"></div>
                <h2>계약자 정보 확인 및 계약서 조회</h2>
            </div>
        </div>
        <div class="explanation-block">
            <div class="inner-container">
                <i></i>
                <p>
                    계약체결 시 입력한 계약자 정보와 동일한 정보를 입력하셔야 계약서 조회가 가능합니다. <br class="pc_pad">
                    만일, 입력 정보가 일치하지 않는 경우 계약업체에 문의하시기 바랍니다.
                </p>
            </div>
        </div>
        <div class="m-title-block mobile">
            <div class="inner-container">
                <h2>계약자 정보 입력</h2>
            </div>
        </div>
        <div class="info-input-block">
            <div class="inner-container">
                <div class="inner-section">
                    <div class="inner-left">
                        <p>계약업체명</p>
                    </div>
                    <div class="inner-right">
                        <div class="inner-right-colum">
                            <p class="company-name">{{cont.member_name}}</p>
                            <div class="company-view">
                                <div class="common-btn small_text gray width-75" id="ci-popup-btn">보기</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="inner-section">
                    <div class="inner-left">
                        <p>이름</p>
                    </div>
                    <div class="inner-right">
                        <input type="text" title="이름" placeholder="이름을 입력하세요." name="member_name">
                    </div>
                </div>
                <div class="inner-section">
                    <div class="inner-left">
                        <p>생년월일</p>
                    </div>
                    <div class="inner-right">
                        <input type="text" title="생년월일" pattern="[0-9]*" inputmode="numeric" maxlength="8" placeholder="생년월일을 입력하세요. (예:19720209)" name="birth_date">
                    </div>
                </div>
                <!-- IF START 'sign_able' -->
                <div class="inner-section">
                    <div class="inner-left">
                        <p>휴대폰번호</p>
                    </div>
                    <div class="inner-right">
                        <div class="inner-right-colum">
                            <div class="right-colum-long">
                                <input type="text" title="휴대폰번호" pattern="[0-9]*" inputmode="numeric" maxlength="12" placeholder="휴대폰번호를 입력하세요. (‘-’제외)" name="hp">
                            </div>
                            <div class="right-colum-short">
                                <input type="button" value="계약확인" class="common-btn small_text" onclick="checkContractInfo();">
                            </div>
                        </div>
                    </div>
                </div>
                <!-- IF END 'sign_able' -->
                <!-- IFNOT START 'sign_able' -->
                <div class="inner-section">
                    <div class="inner-left">
                        <p>휴대폰번호</p>
                    </div>
                    <div class="inner-right">
                        <div class="inner-right-colum">
                            <div class="right-colum-long" style="width: 82%">
                                <input type="text" title="휴대폰번호" pattern="[0-9]*" inputmode="numeric" maxlength="12" placeholder="휴대폰번호를 입력하세요. (‘-’제외)" name="hp">
                            </div>
                            <div class="right-colum-short" style="width: 16%">
                                <input type="button" value="인증번호 요청" class="common-btn small_text" onclick="checkContractInfo();">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="inner-section last">
                    <div class="inner-left">
                        <p>인증번호</p>
                    </div>
                    <div class="inner-right">
                        <div class="inner-right-colum">
                            <div class="right-colum-long" style="width: 82%">
                                <input type="text" title="인증번호" placeholder="인증번호를 입력하세요." name="random_string">
                            </div>
                        </div>
                        <div class="inner-right-colum">
                            <ul class="certification-text">
                                <li>인증번호를 입력하신 후 <strong>‘계약서 조회’</strong>를 누르세요.</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- IFNOT END 'sign_able' -->
            </div>
        </div>
        <!-- IF START 'sign_able' -->
        <div class="privacy-check-block">
            <div class="inner-container">
                <p class="title pc_pad">개인정보 제공 및 이용동의(필수)</p>
                <div class="privacy-contents pc_pad" style="height: 190px;overflow-y: auto;">
                    

<p>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<colgroup><col></colgroup>
<tr>
	<td style="text-align:justify">귀사의 서비스 이용과 관련하여 귀사가 본인의 개인정보를 수집.이용하고자 하는 경우에는 “개인정보 보호법” 제15조, 제22조 및 제24조, “정보통신망 이용촉진 및 정보보호 등에 관한 법률” 제22조에 따라 동의를 얻어야 합니다. 이에 귀사가 아래와 같이 본인의 개인정보를 수집.이용하는데 동의합니다.</td>
</tr>
</table>
</p>

<br>

<p>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<colgroup><col width="20px"><col width="20px"><col></colgroup>
<tr>
	<td valign="top"><b>1.</b></td>
	<td colspan="2" style="text-align:justify"><b>개인정보의 수집·이용 목적</b></td>
</tr>
<tr>
	<td></td>
	<td valign="top">1)</td>
	<td style="text-align:justify">서비스 이용에 따른 본인여부 식별(확인), 실명인증</td>
</tr>
<tr>
	<td></td>
	<td valign="top">2)</td>
	<td style="text-align:justify">전자계약 이용고객 대상 서비스 제공: 서비스이용정보 및 계약관련정보 조회, 계약체결 등</td>
</tr>
<tr>
	<td></td>
	<td valign="top">3)</td>
	<td style="text-align:justify">고지사항 전달, 불만 처리 등 원활한 의사소통 확보, 분쟁조정을 위한 기록보존 등</td>
</tr>
</table>
</p>

<br>

<p>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<colgroup><col width="20px"><col width="20px"><col></colgroup>
<tr>
	<td valign="top"><b>2.</b></td>
	<td colspan="2" style="text-align:justify"><b>수집·이용하는 개인정보의 항목</b></td>
</tr>
<tr>
	<td></td>
	<td valign="top">1)</td>
	<td style="text-align:justify">필수항목</td>
</tr>
<tr>
	<td></td>
	<td></td>
	<td style="text-align:justify">성명, 생년월일, 주소, 핸드폰번호, 전화번호, 이메일주소</td>
</tr>
<tr>
	<td></td>
	<td valign="top">2)</td>
	<td style="text-align:justify">서비스 이용과정에서 자동으로 수집될 수 있는 항목</td>
</tr>
<tr>
	<td></td>
	<td></td>
	<td style="text-align:justify">계약정보, 서비스 이용 기록, 서명기록 등</td>
</tr>
</table>
</p>

<br>

<p>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<colgroup><col width="20px"><col></colgroup>
<tr>
	<td valign="top"><b>3.</b></td>
	<td style="text-align:justify"><b>개인정보의 보유·이용 기간</b></td>
</tr>
<tr>
	<td></td>
	<td style="text-align:justify">개인정보의 수집.이용 목적이 달성되면 파기하는 것을 원칙으로 합니다. 다만, 관계법령(상법,전자금융거래법,전자상거래 등에서의 소비자 보호에 관한 법률 등)에 개인정보를 보유할필요가 있는 경우 일정기간 동안 보유합니다.</td>
</tr>
</table>
</p>

<br>

<p>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
    <colgroup><col width="20px"><col width="20px"><col width="20px"><col width="20px"><col></colgroup>
    <tr>
        <td colspan="5" style="text-align:justify"><b>4. 업무 위탁처리를 위한 개인 정보 제공 현황</b></td>
    </tr>
    <tr>
        <td></td>
        <td colspan="4" style="text-align:justify">1) 당사(계약 작성업체)는 다음 각 호와 같이 개인정보의 처리를 위탁하고 있습니다.</td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td valign="top">①</td>
        <td colspan="2" style="text-align:justify">수탁업체 : ㈜ 농심</td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td valign="top">②</td>
        <td colspan="2" style="text-align:justify">수탁목적 : 농심 전자계약 서비스의 전반적인 이행, 유지, 관리</td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td valign="top">③</td>
        <td colspan="2" style="text-align:justify">개인 정보 제공 항목</td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td></td>
        <td valign="top">-</td>
        <td style="text-align:justify">개인정보 : 성명, 생년월일, 주소, 핸드폰번호, 전화번호, 이메일주소</td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td></td>
        <td valign="top">-</td>
        <td style="text-align:justify">거래 정보 : 계약명, 계약 일자, 계약 서식 내역 정보</td>
    </tr>
    <tr>
        <td></td>
        <td colspan="4" style="text-align:justify">2) 위탁계약 시 개인 정보 보호 관련 법규의 준수, 개인 정보에 관한 제3자 제공 금지 및 책임 부담 등을 명확히 규정하고 있습니다.<br>업체 변경 시 공지사항 및 개인 정보처리 방침을 통해 고지하겠습니다.</td>
    </tr>
</table>
</p>

<br>

<p>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<colgroup><col width="20px"><col></colgroup>
<tr>
	<td valign="top"><b>※</b></td>
	<td style="text-align:justify">귀하는 동의를 거부할 권리가 있으나, 동의하지 않으실 경우 서비스 제공이 불가능할 수 있음을 알려드립니다.</td>
</tr>
</table>
</p>
                </div>
                <div class="privacy-check">
                    <label>
                        <input type="checkbox" name="dc_info_check" value="terms1" id="call-id-terms_0"> 개인정보 제공 및 이용에 동의합니다.
                    </label>
                    <div class="privacy-view-btn mobile">
                        <div class="common-btn small_text line"  id="privacy-popup-btn">내용 보기</div>
                    </div>
                </div>
            </div>
        </div>
        <!-- IF END 'sign_able' -->
        <div class="bottom-btn-block">
            <div class="inner-container">
                <input style="display: none;" id="btn_submit" type="button" value="계약서 조회" class="common-btn width-200" onclick="getContractInfo('{{cust.member_no}}', '{{cont.cont_no}}', '{{cont.cont_chasu}}');">
            </div>
        </div>
    </div>

    <!-- layerpopup -->
    <div class="lp-wrap HeightAuto" id="ci-popup">
        <div class="lp-popup company-info">
            <div class="lp-header">
                <p class="lp-title">계약업체 정보 조회</p>
                <div class="lp-close">
                    <i></i>
                </div>
            </div>
            <div class="lp-container">
                <div class="lp-textarea-block mb-25">
                    <p class="lp-base-text">고객님의 계약업체 정보를 확인하시고 문의사항이 있으시면 계약담당자에게 연락하시기 바랍니다.</p>
                </div>
                <div class="lp-table-company-block">
                    <table>
                        <col width="30%">
                        <col width="70%">
                        <tbody>
                        <tr>
                            <th scope="row">계약업체명</th>
                            <td>{{cont.member_name}}</td>
                        </tr>
                        <tr>
                            <th scope="row">계약명</th>
                            <td>{{cont.cont_name}}</td>
                        </tr>
                        <tr>
                            <th scope="row">담당자</th>
                            <td>{{cont.user_name}}</td>
                        </tr>
                        <tr>
                            <th scope="row">연락처</th>
                            <td>{{cont.tel_num}}</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="lp-background HeightAuto"></div>
    </div>
    <!-- layerpopup -->
</form>

{{form_script}}

<script>
	$(document).ready(function(){
		
		$( "#ci-popup-btn" ).click(function() {
			$("#ci-popup").show();
			$("body").addClass("lp-fixed");
		});
		$( "#privacy-popup-btn" ).click(function() {
			$("#privacy-popup").show();
			$("body").addClass("lp-fixed");
		});
		$( "#service-popup-btn" ).click(function() {
			$("#service-popup").show();
			$("body").addClass("lp-fixed");
		});
		$( ".lp-close" ).click(function() {
			$(top.document).find(".lp-wrap").hide();
			$("body").removeClass("lp-fixed");
		});
		// dskim추가
		$( ".lp-close2" ).click(function() {
			$(top.document).find(".lp-wrap2").hide();
			$("body").removeClass("lp-fixed");
		});
		$('.HeightAuto').css('height' ,  $(window).height());
	});

    function checkContractInfo() {
        var f = document.forms['form1'];
        if(f['dc_info_check']!=null && f['dc_info_check'].checked!=true) {
            alert("개인정보 수집 이용에 동의 후 계약서 확인 가능 합니다.");
            return;
        } else if(!validate(f)) {
            return;
        }

        var url = "./check_msign_contract.jsp";
        var data = {
            "cont_no": '{{cont.cont_no}}'
            , "cont_chasu": '{{cont.cont_chasu}}'
            , "member_name": encodeURIComponent(f['member_name'].value)
            , "birth_date": f['birth_date'].value
            , "hp": f['hp'].value
            , "email_random": '{{cust.email_random}}'
        };
        callJqueryAjax(url, data, callCheckContractInfo);
    }

    function callCheckContractInfo(data) {
        var f = document.forms['form1'];
        if (data == 'true') {
            <!-- IF START 'sign_able' -->
            alert('[계약서 조회] 버튼을 누르고 계약진행을 하시면 됩니다.');
            f['check_contract_info_yn'].value='true';
            document.getElementById("btn_submit").style.display='';
            <!-- IF END 'sign_able' -->

            <!-- IFNOT START 'sign_able' -->
            requestIdentifyRandom();
            <!-- IFNOT END 'sign_able' -->
        } else {
            alert('수신받은 계약서의 계약자 정보와 입력한 정보가 일치하지 않습니다. 입력정보를 확인해 주세요.');
            document.getElementById("btn_submit").style.display='none';
            f['check_contract_info_yn'].value='';
            return;
        }
    }

    function getContractInfo(member_no, cont_no, cont_chasu) {
        var f = document.forms['form1'];
        <!-- IF START 'sign_able' -->
        if(f['dc_info_check'].checked!=true) {
            alert("개인정보 수집 이용에 동의 후 계약서 확인 가능 합니다.");
            return;
        } else if(f['check_contract_info_yn'].value!='true') {
            alert('계약확인 후 조회를 진행하세요');
            return;
        }
        //window.open('/web/buyer/identify/identifyCheckplus.jsp?member_no=' + member_no + '&cont_no=' + cont_no + '&cont_chasu=' + cont_chasu, '_blank');
        f['sign_dn'].value = '3232323232323';
        f['sign_data'].value = Base64.encode('2121212121221');
        f.action = "./email_contract_msign_recvview.jsp";
        f.submit();
        <!-- IF END 'sign_able' -->

        <!-- IFNOT START 'sign_able' -->
        var url = "./check_msign_contract.jsp";
        var data = {"cont_no": '{{cont.cont_no}}'
            ,"cont_chasu": '{{cont.cont_chasu}}'
            ,"member_name": encodeURIComponent(f['member_name'].value)
            ,"birth_date": f['birth_date'].value
            ,"hp": f['hp'].value
            ,"email_random": '{{cust.email_random}}'
            ,"random_string": f['random_string'].value
            ,"random_chk": 'Y'	// 인증번호 체크
        };
        callJqueryAjax(url, data, callGetContractInfo);
        <!-- IFNOT END 'sign_able' -->
    }

    function identifyCallback(ci, user_name, birth_date, hp, text, gender) {
        var f = document.forms["form1"];
        // 20200928 : B2C계약의 경우 계약당사자의 이름으로 비교하도록 수정
        // if('{{cust.boss_name}}' == user_name
        if('{{cust.member_name}}' == user_name
            && '{{cust.hp1}}{{cust.hp2}}{{cust.hp3}}' == hp
            && '{{cust.boss_birth_date}}' == birth_date
        ) {
            f['sign_dn'].value = ci;
            f['sign_data'].value = Base64.encode(text);
            f.action = "./email_contract_msign_recvview.jsp";
            f.submit();
        } else {
            alert('계약자 본인확인에 실패했습니다.');
            return false;
        }
    }

    function callGetContractInfo(data) {
        var f = document.forms['form1'];
        if(data=='true') {
            f.action = "./email_contract_msign_recvview.jsp";
            f.submit();
        } else if (data == 'false_01') {
            alert('인증번호가 존재하지 않습니다. 인증요청을 먼저하셔야 합니다.');
            return;
        } else if(data=='false_02') {
            alert('인증번호가 일치하지 않습니다.');
            return;
        } else {
            alert('수신받은 계약서의 계약자 정보와 입력한 정보가 일치하지 않습니다. 입력정보를 확인해 주세요.');
            return;
        }
    }

    function requestIdentifyRandom() {
        var url = "./send_msign_random.jsp";
        var data = {
            "cont_no": '{{cont.cont_no}}'
            , "cont_chasu": '{{cont.cont_chasu}}'
            , "email_random": '{{cust.email_random}}'
        };
        callJqueryAjax(url, data, callRequestIdentifyRandom);
    }

    function callRequestIdentifyRandom(data) {
        if(data.length > 0 && data=='true') {
            alert('입력한 휴대폰번호로 인증번호가 전송되었습니다. 인증번호를 입력 후 [계약서 조회] 버튼을 클릭하세요.');
            document.getElementById("btn_submit").style.display='';
            return;
        } else {
            alert('인증코드 생성 중 오류가 발생했습니다.');
            return;
        }
    }
    
    

    function callJqueryAjax(url, postData, callback) {
    	$.ajax({
            url : url,
            type : "post",
            data : postData,
            success : function(data) {
                if (data!=null && data.trim().length > 0) {
                    if (typeof callback === "function") {
    					callback(data.trim());
                    }
                } else {
                    alert("조회 중 오류가 발생했습니다.");
                }
            },
            error : function(request, status, error) {
                alert("code:" + request.status + "\n" + "error:" + error);
            }
        });
    }
    

    window.old_alert = window.alert;

    window.alert = function(message){
    	$("#alert_msg").html(message);
    	$("#div_alert").show();
    };

    window.confirm = function(message, callback){
    	$("#confirm_msg").html(message.replaceAll("\n","<br>"));
    	$("#div_confirm").show();
    	$("#btn_confirm_accpet").click(callback);
    };
</script>
