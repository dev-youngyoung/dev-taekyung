<!-- 전자인증 모듈 설정 //-->
<!-- INCLUDE FILE 'layout/crosscert_include.html' -->
<!-- 전자인증 모듈 설정 //-->
<form name="form1" method="post">
<input type="hidden" name="sign_dn">
<input type="hidden" name="sign_data">
<input type="hidden" name="sinput">

<div class="dc-step-wrap step1">
	<ol>
	<li>
		<div class="text_wrap">
			<div class="text active">개인 정보 수집 및 이용 동의 / 본인확인</div>
		</div>
	</li>
	<li>
		<div class="text_wrap">
			<div class="text">계약서 확인 및 서명</div>
		</div>
	</li>
	<li>
		<div class="text_wrap">
			<div class="text">서명완료</div>
		</div>
	</li>
	</ol>
</div>

<div class="div_table">
	<div class="util-row">
	    <div class="push-left">
	        <h3>개인 정보 수집 및 이용에 대한 동의</h3>
	    </div>
	</div>
</div>

<div class="cont_warp" style="margin-top:-30px">
	<div id="__html">
		<div style="padding-top: 0px" id="__html_0">




<p>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<colgroup><col></colgroup>
<tr>
	<td style="text-align:justify">고객님의 개인 정보 수집 및 이용목적, 수집하는 개인 정보의 항목, 개인 정보의 보유 및 이용 기간 안내입니다.</td>
</tr>
</table>
</p>

<p>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<colgroup><col width="20px"><col></colgroup>
<tr>
	<td colspan="2" style="text-align:justify"><b>1. 수집 및 이용목적</b></td>
</tr>
<tr>
	<td></td>
	<td style="text-align:justify">전자계약 체결 및 관리</td>
</tr>
</table>
</p>

<p>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<colgroup><col width="20px"><col></colgroup>
<tr>
	<td colspan="2" style="text-align:justify"><b>2. 수집하는 개인 정보 항목</b></td>
</tr>
<tr>
	<td></td>
	<td style="text-align:justify">대표자명, 담당자명, 담당자 전화번호, 담당자 이메일, 담당자 휴대전화 번호</td>
</tr>
</table>
</p>

<p>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<colgroup><col width="20px"><col></colgroup>
<tr>
	<td colspan="2" style="text-align:justify"><b>3. 보유 및 이용 기간</b></td>
</tr>
<tr>
	<td></td>
	<td style="text-align:justify">수집된 날로부터 제공된 목적을 달성할 때까지 보유·이용됩니다.<br>제공된 목적 달성 후에는 위에 기재된 이용목적과 관련된 업무처리를 위하여 필요한 범위 내에서만 보유·이용됩니다.</td>
</tr>
</table>
</p>

<p>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<colgroup><col width="20px"><col width="20px"><col width="20px"><col width="20px"><col></colgroup>
<tr>
	<td colspan="5" style="text-align:justify"><b>4. 업무 위탁처리를 위한 개인 정보 제공 현황</b></td>
</tr>
<tr>
	<td></td>
	<td colspan="4" style="text-align:justify">1) 당사(계약 작성업체)는 다음 각 호와 같이 개인정보의 처리를 위탁하고 있습니다.</td>
</tr>
<tr>
	<td></td>
	<td></td>
	<td valign="top">①</td>
	<td colspan="2" style="text-align:justify">수탁업체 : 나이스디앤알㈜</td>
</tr>
<tr>
	<td></td>
	<td></td>
	<td valign="top">②</td>
	<td colspan="2" style="text-align:justify">수탁목적 : 나이스다큐 전자계약 서비스의 전반적인 이행, 유지, 관리</td>
</tr>
<tr>
	<td></td>
	<td></td>
	<td valign="top">③</td>
	<td colspan="2" style="text-align:justify">개인 정보 제공 항목</td>
</tr>
<tr>
	<td></td>
	<td></td>
	<td></td>
	<td valign="top">-</td>
	<td style="text-align:justify">개인정보 : 대표자명, 담당자명, 담당자전화번호, 담당자 이메일, 담당자 휴대전화 번호</td>
</tr>
<tr>
	<td></td>
	<td></td>
	<td></td>
	<td valign="top">-</td>
	<td style="text-align:justify">거래 정보 : 계약명, 계약 일자, 계약 서식 내역 정보</td>
</tr>
<tr>
	<td></td>
	<td colspan="4" style="text-align:justify">2) 위탁계약 시 개인 정보 보호 관련 법규의 준수, 개인 정보에 관한 제3자 제공 금지 및 책임 부담 등을 명확히 규정하고 있습니다.<br>업체 변경 시 공지사항 및 개인 정보처리 방침을 통해 고지하겠습니다.</td>
</tr>
</table>
</p>

<p>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
	<colgroup><col width="20px"><col></colgroup>
	<tr>
		<td valign="top"><b>※</b></td>
		<td style="text-align:justify">귀하는 동의를 거부할 권리가 있으나, 동의하지 않으실 경우 서비스 제공이 불가능할 수 있음을 알려드립니다.</td>
	</tr>
</table>
</p>

			
		</div>
	</div>
	<div class="util-row">
		<div class="push-right" style="padding-right:80px;margin-top:-20px">
			<label for="dc_info_check"><input type="checkbox" name="dc_info_check" id="dc_info_check">개인 정보 수집 및 이용에 대한 동의내용을 숙지하였으며, 이에 동의합니다. <span style="color:red">(필수)</span></label>
		</div>
	</div>
</div>			

<div class="btn-group-wrap">
	<button type="button" class="btn color" onclick="fSign();">공인인증서 본인확인</button>
	<button type="button" class="btn" onclick="window.close();">닫기</button>
</div>

<br>
<div class="help-content">
    <h3>NOTICE<span>사용전에 알아두세요~ </span></h3>
    <div class="help-content-body">
        <h4>안내 및 유의사항</h4>
        <ul>
			<li>공인인증서로 본인확인 후 수신 계약서를 확인할 수 있습니다.<br>(사용 가능 공인인증서 : <!-- IF START 'person_yn' -->개인 범용인증서[금융기관용 공인인증서 이용 불가]<!-- IF END 'person_yn' --><!-- IFNOT START 'person_yn' -->사업자 범용 공인인증서, 나이스다큐 전용 공인인증서<!-- IFNOT END 'person_yn' -->)</li>
			<!-- IF START 'person_yn' -->
			<li>인증서 발급방법 [거래은행 사이트(즉시발급), <a href="javascript:OpenWindow('../html/contract/subscription_pop.html','cert','500','630');" style="color:blue;text-decoration:underline">인증서발급</a></li>
			<!-- IF END 'person_yn' -->
			<li>수신 계약서에 전자서명 후 계약 진행 현황 및 체결 완료된 계약서는 ‘일반기업용 나이스다큐’에 회원가입하여 확인할 수 있습니다.</li>
			<li>시스템 문의는 나이스다큐 고객센터 &nbsp;&nbsp;&nbsp; ☎ 02-788-9097</li>
        </ul>
    </div>
</div>
        
</form>

<script>
attachOnload( function(){
        //alert("★★★  공지사항  ★★★\n 1. 수신 받은 계약서에 대해 본인 확인을 위해 공인인증서가 필요합니다.\n\n2. 공인인증서로 본인 확인이 완료 되면 계약서를 확인 할 수 있습니다.\n\n\n★★★  공인인증서 모듈 설치 안내  ★★★\n\n\ 1. 공인인증서 모듈이 설치 되어 있지 않은 경우 자동으로 모듈설치 화면으로 이동합니다.\n\n 2. 설치가 완료되면 메일의 [상세보기] 버튼을 다시 클릭 하시기 바랍니다.");
    });

    function fSign()
    {
        var f = document.forms["form1"];

        if(f['dc_info_check'].checked!=true){
        	alert("개인정보 수집 이용에 동의 후 계약서 확인 가능 합니다.");
        	return;
        }

        var vendcd = '';
        <!-- IF START 'person_yn' -->
        setUniSign("person");

        vendcd = "{{jumin_no}}";
        var sinput = null;
        if(f['sinput'].value=='') {
            fLayerPopClose('pop_sign_val');
            fLayerPop('pop_sign_val',"./pop_sign_val.jsp",480,250);
            return;
        } else {
            vendcd = vendcd + f['sinput'].value;
            if (vendcd.length != 13) {
                alert("주민등록번호가 부정확 합니다.\n\n고객센터로 문의하세요.");
                return;
            }
        }
        <!-- IF END 'person_yn' -->
        <!-- IFNOT START 'person_yn' -->
        setUniSign("comp");

        vendcd = "{{cust.vendcd}}";
        <!-- IFNOT END 'person_yn' -->

        unisign.SignDataNVerifyVID(vendcd, null, vendcd,
            function(rv, signedText, certAttrs)
            {
                sSignData = signedText;

                if ( null === sSignData || '' === sSignData || false === rv )
                {
                    unisign.GetLastError(
                        function(errCode, errMsg)
                        {
                            if(errCode == "999"){
                                //사용자 취소
                                f['sinput'].value="";
                            }else if(errCode == "14208"){
                                f['sinput'].value="";
                                alert("선택한 인증서는 귀사의 인증서가 아닙니다.");
                            }else{
                                f['sinput'].value="";
                                alert('Error code : ' + errCode + '\n\nError Msg : ' + errMsg);
                            }
                        }
                    );
                } else {
                    //console.log(JSON.stringify(certAttrs,null,2));
                    //인증서 확인 단계
                    var signEnddt = getFormatDate(certAttrs.validateTo);
                    if (signEnddt.length < 8){
                        alert("유효하지 않은 인증서입니다.(유효일자 미확인)\n\n다시 한번 인증서를 확인 하십시오.");
                        return;
                    }
                    if (!isValidDate(signEnddt))
                    {
                        alert("유효하지 않은 인증서입니다.(유효일자 미확인)\n\n다시 한번 인증서를 확인 하십시오.");
                        return;
                    }
                    if (js_isDateCmp(signEnddt, "{{_sysdate}}"))
                    {
                        alert("유효기간이 지난 인증서 입니다.\n\n다시 한번 인증서를 확인 하십시오.");
                        return;
                    }

                    f['sign_dn'].value = certAttrs.subjectName;
                    f['sign_data'].value = sSignData;
                    f.target = "";
                    f.action = "";
                    f.submit();
                }
            }
        );
        return false;
    }

    function fIdentifyRandom() {
        var f = document.forms["form1"];

        if(f['dc_info_check'].checked!=true){
            alert("개인정보 수집 이용에 동의 후 계약서 확인 가능 합니다.");
            return;
        }

        fLayerPopClose('pop_sign_val');
        fLayerPop('pop_sign_val',"./pop_random_val.jsp?{{query}}",480,270);
    }

    function fLayerPop(layerID, htmlSrc, width, height, xPos, yPos)
    {
        adjX = xPos ? xPos : (document.body.scrollWidth/2 - width/2);
        adjY = yPos ? yPos : (document.body.scrollHeight/2 - height);

        var	iframe = document.createElement('iframe');
        iframe.style.position	= "absolute";
        iframe.style.width		= width+"px";
        iframe.style.height		= height+"px";

        iframe.style.top		= adjY+"px";
        iframe.style.left		= adjX+"px";

        // 오른쪽 경계 넘어가면 위치 조정
        var xMax = parseInt(document.body.clientWidth);
        if( (parseInt(adjX)+parseInt(iframe.style.width)) > xMax)
            iframe.style.left = xMax - parseInt(iframe.style.width) - 20;

        iframe.id				=	layerID;
        iframe.zIndex=11;
        iframe.marginwidth		=	"0px";
        iframe.marginheight		=	"0px";
        iframe.scrolling		=	"no";
        iframe.frameBorder		=	"0px";
        iframe.src				=	htmlSrc;
        document.body.appendChild(iframe);
    }
</script>