<script language="javascript" type="text/javascript" src="../html/js/circletype.min.js"></script>
<script language="javascript" type="text/javascript" src="../html/js/html2canvas.js"></script>
<script language="javascript" type="text/javascript" src="../html/js/html2pdf.bundle.js"></script>
<style type="text/css">
.outer_circle {
	position: relative;
	top:0px;
	width:132px;
	height:132px;
	border:4px solid red;
	border-radius:50%;
	}

.inner_circle {
	position: absolute;
	width:65px;
	height:65px;
	top: 30px;
	left: 30px;
	overflow: hidden;
	border:4px solid red;
	border-radius:50%;
	padding:0px;
	margin: 0px
}
.inner_box{
	position: absolute;
	width:56px;
	height:40px;
	top: 2px;
	left: 1px;
	font-weight: bold;
	font-size: 20px;
	color:red;
	z-index:10;
	text-align: center;
	vertical-align: middle;
	line-height: 23px;
}
.top_text{
	position: absolute;
	top: 0px;
	left: 0px;
	width:125px;
	height:60px;
	font-size : 20px !important;
	font-weight: bold;
	color:red;
	text-align: center;
	vertical-align: middle;
}
.top_text span{
	font-size : 20px !important;
	font-weight: bold;
}
.bottom_text{
	position: absolute;
	top: 65px;
	left: 0px;
	width:125px;
	height:62px;
	font-weight: bold;
	font-size: 18px;
	color:red;
	text-align: center;
	vertical-align: middle;
	-ms-transform: rotate(180deg);
	-webkit-transform: rotate(180deg);
	transform: rotate(180deg);
}
.bottom_text span{
	font-size : 18px !important;
	font-weight: bold;
}
</style>

<div style="width:100%;margin-bottom:10px;" align="right">
<button type="button" class="sbtn color ico-save" onclick="uploadStampImg()"><span></span>저장</button>
<button type="button" class="sbtn color ico-cancel"  onclick="self.close();"> <span></span>닫기</button>
</div>

<form name="form1" method="post">
<input type="hidden" name="stamp_files"/>
<div class="search_div">
<table class="search_table">
<colgroup>
	<col width="120px"/>
	<col width="*"/>
</colgroup>
<tr>
	<th><p>업체명</p></th>
	<td><input type="text" name="s_member_name" maxlength="10" style="width:95%" onkeyup="setCustName(this.value)"></td>
</tr>
</table>
</div>
</form>

<div class="div_table">
<div class="util-row">
    <div class="push-left">
    	<h3>이미지생성</h3>
    </div>
</div>
<table>
<colgroup>
	<col width="150px"/>
	<col width="150px"/>
	<col width="150px"/>
</colgroup>
<tr style="height: 160px;">
<td align="center">
	<div class="container" style="width: 140px;height: 140px;">
		<div class="outer_circle">
			<div class="top_text" >작성중</div>
			<div class="inner_circle">
				<div class="inner_box">전자<br>문서</div>
			</div>
			<div class="bottom_text" >★{{member.member_name}}★</div>
		</div>
	</div>
</td>
<td align="center">
	<div class="container" style="width: 140px;height: 140px;">
		<div class="outer_circle">
			<div class="top_text" >반 려</div>
			<div class="inner_circle">
				<div class="inner_box">전자<br>문서</div>
			</div>
			<div class="bottom_text" >★{{member.member_name}}★</div>
		</div>
	</div>
</td>
<td align="center">
	<div class="container" style="width: 140px;height: 140px;">
		<div class="outer_circle">
			<div class="top_text" >진행중</div>
			<div class="inner_circle">
				<div class="inner_box">전자<br>문서</div>
			</div>
			<div class="bottom_text" >★{{member.member_name}}★</div>
		</div>
	</div>
</td>
<td align="center">
	<div class="container" style="width: 140px;height: 140px;">
		<div class="outer_circle">
			<div class="top_text" >발급요청중</div>
			<div class="inner_circle">
				<div class="inner_box">전자<br>문서</div>
			</div>
			<div class="bottom_text" >★{{member.member_name}}★</div>
		</div>
	</div>
</td>
<td align="center">
	<div class="container" style="width: 140px;height: 140px;">
		<div class="outer_circle">
			<div class="top_text" >발급중</div>
			<div class="inner_circle">
				<div class="inner_box">전자<br>문서</div>
			</div>
			<div class="bottom_text" >★{{member.member_name}}★</div>
		</div>
	</div>
</td>
<td align="center">
	<div class="container" style="width: 140px;height: 140px;">
		<div class="outer_circle">
			<div class="top_text" >발급완료</div>
			<div class="inner_circle">
				<div class="inner_box">전자<br>문서</div>
			</div>
			<div class="bottom_text" >★{{member.member_name}}★</div>
		</div>
	</div>
</td>
</tr>
</table>
</div>

<!-- IF START 'stamp_file_yn' -->
<div class="div_table">
<div class="util-row">
    <div class="push-left">
    	<h3>저장된 이미지</h3>
    </div>
</div>
<table>
<colgroup>
	<col width="150px"/>
	<col width="150px"/>
	<col width="150px"/>
</colgroup>
<tr style="height: 160px;">
<td align="center">
	<img src="/file/bcontract/proof/stamp/{{member_no}}/pdf_stamp_writing.gif?sysdate={{_sysdate}}">
</td>
<td align="center">
	<img src="/file/bcontract/proof/stamp/{{member_no}}/pdf_stamp_returned.gif?sysdate={{_sysdate}}">
</td>
<td align="center">
	<img src="/file/bcontract/proof/stamp/{{member_no}}/pdf_stamp_pending2.gif?sysdate={{_sysdate}}">
</td>
<td align="center">
	<img src="/file/bcontract/proof/stamp/{{member_no}}/pdf_stamp_pending.gif?sysdate={{_sysdate}}">
</td>
<td align="center">
	<img src="/file/bcontract/proof/stamp/{{member_no}}/pdf_stamp_issued.gif?sysdate={{_sysdate}}">
</td>
<td align="center">
	<img src="/file/bcontract/proof/stamp/{{member_no}}/pdf_stamp_completed.gif?sysdate={{_sysdate}}">
</td>
</tr>
</table>
</div>
<!-- IF END 'stamp_file_yn' -->


<script type="text/javascript">
    var container_area = document.getElementsByClassName("container")
	var top_text_area = document.getElementsByClassName('top_text');
	var bottom_text_area = document.getElementsByClassName('bottom_text');
	var stamp_count = container_area.length;

    for(var i = 0; i < stamp_count; i++){
        new CircleType(top_text_area[i]).radius(65);
        new CircleType(bottom_text_area[i]).radius(65);
    }

	function setCustName(cust_name) {
        for(var i = 0; i < stamp_count; i++){
            bottom_text_area[i].innerHTML = "★" + cust_name + "★";
            new CircleType(bottom_text_area[i]).radius(65);
        }
	}

	function uploadStampImg() {
        var f = document.forms['form1'];
        var stamp_files = '';
        for(var i = 0; i < stamp_count; i++) {
            html2canvas(container_area[i], {backgroundColor: 'transparent'})
			.then(function (canvas) {
                stamp_files += canvas.toDataURL("image/gif");
                f['stamp_files'].value = stamp_files;
                f.submit();
			}).catch(function (err) {
				alert(err);
            });
        }
	}
</script>
{{form_script}}
